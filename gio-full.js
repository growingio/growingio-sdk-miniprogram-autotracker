var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+n+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,i=arguments.length;i>n;n++)for(var r in t=arguments[n])({}).hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)};function i(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))}function r(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function o(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;o>r;r++)!i&&r in t||(i||(i=[].slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||[].slice.call(t))}var a={autotrack:{type:"boolean",default:!0},cml:{type:"object",default:!1},dataCollect:{type:"boolean",default:!0},debug:{type:"boolean",default:!1},followShare:{type:"boolean",default:!0},forceLogin:{type:"boolean",default:!1},subpackage:{type:"boolean",default:!1},keepAlive:{type:"number",default:3e5},remax:{type:["object","module"],default:!1},requestTimeout:{type:"number",default:5e3},taro:{type:["object","module"],default:!1},taroVue:{type:["object","function"],default:!1},tbConfig:{type:"object",default:{cloudFuncSend:!1,cloudFuncName:"httpTunnel",cloudFuncHandler:"main",cloudAppId:void 0,path:void 0}},uniVue:{type:["object","function"],default:!1},version:{type:"string",default:"1.0.0"},wepy:{type:"function",default:!1}},s={compress:{type:"boolean",default:!0},enableIdMapping:{type:"boolean",default:!1},extraParams:{type:"array",default:[]},gtouchHost:{type:"string",default:"cdp.growingio.com"},host:{type:"string",default:"napi.growingio.com"},ignoreFields:{type:"array",default:[]},scheme:{type:"string",default:"https"},uploadInterval:{type:"number",default:1e3},performance:{type:"object",default:{monitor:!0,exception:!0}}},u={},l=["clearUserId","enableDebug","getGioInfo","getOption","identify","init","setAutotrack","setDataCollect","setOption","setUserId","track","setLocation","setGeneralProps","clearGeneralProps","setPageAttributes","updateImpression"];o(o([],l),["setEvar","setPage","setUser","setVisitor"]);var c,d,g,p,v,f,h,m,I=o(o([],l),["setTrackerHost","setTrackerScheme","setUserAttributes","registerPlugins","getDeviceId","trackTimerStart","trackTimerPause","trackTimerResume","trackTimerEnd","removeTimer","clearTrackTimer"]),y=["autotrack","dataCollect","debug","host","scheme"],w={autotrack:"无埋点",dataCollect:"数据采集",debug:"调试模式"},S=["setConfig","collectImp","setPlatformProfile","getLocation"],O=["deviceBrand","deviceModel","deviceType","networkState","screenHeight","screenWidth","operatingSystem"],b=o(o([],O),["appChannel","language","platformVersion"]),T=function(e){return["undefined","null"].includes(X(e))},_=function(e){return"string"===X(e)},P=function(e){return"number"===X(e)},E=function(e){return"boolean"===X(e)},k=function(e){return"[object Object]"==={}.toString.call(e)&&!T(e)},C=function(e){return["function","asyncfunction"].includes(X(e))},x=function(e){return Array.isArray(e)&&"array"===X(e)},A=function(e){try{return Array.from(e)[0]}catch(e){return}},N=function(e){try{var t=Array.from(e);return t[t.length-1]}catch(e){return}},q=function(e,t){return void 0===t&&(t=1),x(e)&&P(t)?e.slice(t>0?t:1,e.length):e},V=function(e){if(x(e)){for(var t=0,n=[],i=0,r=e;i<r.length;i++){var o=r[i];o&&!J(o)&&(n[t++]=o)}return n}return e},H=function(e,t){if(x(e)){var n=e.findIndex(t);return 0>n?void 0:e[n]}},j=function(e,t){return!(!x(e)||!x(t)||e.length!==t.length)&&e.every((function(e,n){return e===t[n]}))},F=function(e){return T(e)?"":""+e},L=function(e,t){return"string"===X(e)?e.split(t):e},D=function(e){if(_(e)){var t=L(e,"");return""+A(t).toLowerCase()+q(t).join("")}return e},R=function(e,t){return e.slice(0,t.length)===t},M=function(e,t){var n=e.length,i=n;i>n&&(i=n);var r=i;return(i-=t.length)>=0&&e.slice(i,r)===t},B={}.hasOwnProperty,U=function(e,t){return null!=e&&("object"==typeof e||"function"==typeof e)&&B.call(e,t)},G=function(e){return k(e)?Object.keys(e):[]},$=function(e,t){G(e).forEach((function(n){return t(e[n],n)}))},K=function(e,t){var n=G(e);return!(!k(e)||!k(t)||n.length!==G(t).length||n.map((function(n,i){return k(e[n])?K(e[n],t[n]):e[n]===t[n]})).includes(!1))},Q=function(e,t,n){var i=e;return k(e)?(t.split(".").forEach((function(e){i=i?i[e]:n})),i):n},W=function(e,t){if(!k(e))return!1;try{if("string"===X(t))return delete e[t];if("array"===X(t))return t.map((function(t){return delete e[t]}));"object"===X(t)&&t.constructor===RegExp&&G(e).forEach((function(n){t.test(n)&&W(e,n)}))}catch(e){return!1}},z=function(e,t,n,i){var r;void 0===t&&(t=250);var o=0;return"boolean"!==X(n)&&(i=e,e=n,n=void 0),function(){for(var a=[],s=0;arguments.length>s;s++)a[s]=arguments[s];var u=this,l=Date.now()-o;function c(){o=Date.now(),e.apply(u,a)}i&&!r&&c(),r&&clearTimeout(r),void 0===i&&l>t?c():!0!==n&&(r=setTimeout(i?function(){r=void 0}:c,void 0===i?t-l:t))}},J=function(e){return x(e)?0===e.length:k(e)?0===G(e).length:!e},X=function(e){return{}.toString.call(e).slice(8,-1).toLowerCase()},Z=Object.freeze({__proto__:null,isNil:T,isString:_,isNumber:P,isBoolean:E,isObject:k,isRegExp:function(e){return"[object RegExp]"==={}.toString.call(e)},isFunction:C,isArray:x,isDate:function(e){return"date"===X(e)},fixed:function(e,t){return P(e)?Number(e.toFixed(P(t)?t:2)):_(e)&&"NaN"!==F(Number(e))?Number(Number(e).toFixed(P(t)?t:2)):e},head:A,last:N,drop:q,dropWhile:function(e,t){return x(e)?e.filter((function(e){return!t(e)})):e},compact:V,find:H,isEqualArray:j,toString:F,split:L,lowerFirst:D,upperFirst:function(e){if(_(e)){var t=L(e,"");return""+A(t).toUpperCase()+q(t).join("")}return e},startsWith:R,endsWith:M,hasOwnProperty:B,has:U,keys:G,forEach:$,isEqual:K,get:Q,unset:W,throttle:z,isEmpty:J,typeOf:X,formatDate:function(e){function t(e){return 10>e?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds())}}),Y=function(e,t){console.log("%c[GrowingIO]："+e,{info:"color: #3B82F6;",error:"color: #EF4444",warn:"color: #F59E0B",success:"color: #10B981"}[t]||"")},ee=function(e){try{return e()}catch(e){return}},te=function(e){return _(e)?e.trim().substring(0,100):e},ne=function(e,t){return _(e)&&!J(e)&&e.match(/^[a-zA-Z_][0-9a-zA-Z_]{0,100}$/)?t():(Y("事件名格式不正确，只能包含数字、字母和下划线，且不能以数字开头，字符总长度不能超过100!","error"),!1)},ie=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},re=function(e){return e.pixelRatio?Math.round(e.screenHeight*e.pixelRatio):e.screenHeight},oe=function(e){return e.pixelRatio?Math.round(e.screenWidth*e.pixelRatio):e.screenWidth},ae=function(e,t){if(e){var n=e.toLowerCase();return-1!==n.indexOf("android")?t+"-Android":-1!==n.indexOf("ios")?t+"-iOS":e}},se=function(e){if(_(e)){var t=e.indexOf("?");return-1!==t?[e.substring(0,t),e.substring(t+1)]:[e,""]}return["",""]},ue=function(e){return _(e)?e.startsWith("/")?e:"/"+e:""},le=function(e){var t=e.Current,n=e.createComponent;return!(!e||!t||n)},ce=function(e){return ee((function(){switch(e){case"wx":return wx;case"my":return my;case"swan":return swan;case"tt":return tt;case"qq":return qq;case"ks":return ks;case"jd":return jd;default:var t=void 0;return t||(t=ee((function(){return swan}))),t||(t=ee((function(){return my}))),t||(t=ee((function(){return tt}))),t||(t=ee((function(){return qq}))),t||(t=ee((function(){return ks}))),t||(t=ee((function(){return jd}))),t||(t=ee((function(){return wx}))),t}}))},de=function(e){return ee((function(){switch(e){case"wx":return __wxConfig;case"swan":return appConfig;case"tt":return ee((function(){return __ttConfig}))||(null===global||void 0===global?void 0:global.TMAConfig)||(null===globalThis||void 0===globalThis?void 0:globalThis.TMAConfig);case"qq":return __qqConfig;case"ks":return __ksConfig;case"jd":return __jdConfig;default:return}}))},ge=function(e){return ee((function(){switch(e){case"wx":case"qq":return __wxAppCode__;case"tt":return __allConfig__;case"ks":return __module__;case"jd":return __jdAppCode__;default:return}}))},pe=function(){var e;return!e&&ee((function(){return swan}))&&(e="swan"),!e&&ee((function(){return tt}))&&(e="tt"),!e&&ee((function(){return qq}))&&(e="qq"),!e&&ee((function(){return my}))&&(e="my"),!e&&ee((function(){return ks}))&&(e="ks"),!e&&ee((function(){return jd}))&&(e="jd"),!e&&ee((function(){return wx}))&&(e="wx"),e||H(G(global),(function(e){return F(e).toLowerCase().includes("quickapp")}))&&(e="quickapp"),e},ve=function(e){return G(e).filter((function(e){return e.indexOf("__sub")>-1&&e.indexOf("gio__")>-1})).sort()},fe=function(){var e=ee((function(){return getApp({allowDefault:!0})}));return e||(e=he()),e},he=function(){var e;return null!==(e=ee((function(){return $global})))&&void 0!==e?e:global},me=function(e){var t={};return k(e)&&$(e,(function(e,n){var i=F(n).slice(0,100);k(e)?t[i]=me(e):x(e)?(t[i]=e.slice(0,100),"cdp"===he().gioEnvironment?t[i]=t[i].join("||").slice(0,1e3):t[i]=F(t[i]).slice(0,1e3)):t[i]=T(e)?"":F(e).slice(0,1e3)})),t},Ie=function(e,t){var n=function(){return t.map((function(t){return e.getStorageSync(t)}))};try{return e.minip.canIUse("batchGetStorageSync")?e.minip.batchGetStorageSync(t):n()}catch(e){return n()}},ye=function(e,t){var n=function(){return t.map((function(t){var n=t.key,i=t.value;return e.setStorageSync(n,i)}))};try{return e.minip.canIUse("batchSetStorageSync")?e.minip.batchSetStorageSync(t):n()}catch(e){return n()}},we=function(e){return G(e||{}).map((function(t){return t?t+"="+(T(e[t])?"":e[t]):""})).join("&")},Se=function(e){(R(e,"?")||R(e,"&"))&&(e=e.slice(1,e.length));var t={};return e.split("&").forEach((function(e){var n=e.split("=");n[0]&&(t[n[0]]=n[1])})),t},Oe=function(e){var t=0;if(J(e)||"boolean"==typeof e)return t;for(var n=0;n<e.length;)t=(t<<5)-t+e.charCodeAt(n),t&=t,n++;return t},be=["wxShoppingListScene","$taroTimestamp"],Te=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n="string"==typeof e?Se(e):e||{};function i(e,t){if("object"!=typeof e||null===e||Array.isArray(e))return e;var i={};return G(e).forEach((function(r){var o=be.some((function(e){return r.includes(e)})),a=U(n,r);if(!(o||t&&a)){var s=e[r];"string"==typeof s?be.some((function(e){return s.includes(e)}))||(i[r]=s):"number"!=typeof s&&"boolean"!=typeof s||(i[r]=s)}})),i}return Object.assign({},i(n,!1),i(t,!0))},_e=Object.freeze({__proto__:null,consoleText:Y,niceTry:ee,limitString:te,eventNameValidate:ne,guid:ie,getScreenHeight:re,getScreenWidth:oe,getOS:ae,compareVersion:function(e,t){void 0===e&&(e=""),void 0===t&&(t="");for(var n=function(e){return e.replace(/\s+/g,"")},i=function(e){return e.replace(/[vV]/g,"")},r=n(i(e)),o=n(i(t)),a=r.split("."),s=o.split("."),u=0;3>u;u++){var l=Number(a[u]),c=Number(s[u]);if(l>c)return 1;if(c>l)return-1;if(!isNaN(l)&&isNaN(c))return 1;if(isNaN(l)&&!isNaN(c))return-1}return 0},getVueVersion:function(e){if(e){var t=Number(A(L(e.version,".")));return Number.isNaN(t)?0:t}return 0},splitPath:se,normalPath:ue,isTaro3:le,getPlainMinip:ce,getPlainConfig:de,getPlainAppCode:ge,getPlainPlatform:pe,getSubKeys:ve,getAppInst:fe,getGlobal:he,limitObject:me,batchGetStorageSync:Ie,batchSetStorageSync:ye,qsStringify:we,qsParse:Se,hashCode:Oe,getPureParams:Te}),Pe=function(e){return _(e)&&e.length>0||P(e)&&e>0},Ee=/^((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}/i,ke=/^(https?:\/\/)|(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&?[a-zA-Z0-9_-](\?)?)*)*$/i,Ce=/^e[0-9]+(_[0-9]+)?$/,xe=/^__reactProps\$[a-z0-9]+$/i,Ae=/return [$\w]+.\w+\(/,Ne=/return \w+\(/,qe=/return [$\w]+.\$emit\(['"]\w+/,Ve=/return [$\w]+.\w+/,He=/return [$\w]+/,je={name:"gioUniAppAdapter",method:function(e){var t,n,i=this;this.growingIO=e,this.main=function(){var e,t;switch(i.uniVue||(i.uniVue=null===(t=null===(e=i.growingIO)||void 0===e?void 0:e.vdsConfig)||void 0===t?void 0:t.uniVue),console.log("Vue version: ",i.uniVue.version),Number(c.head(c.split(i.uniVue.version,".")))){case 2:i.uniVue2Proxy();break;case 3:i.uniVue3Proxy(i.uniVue);break;default:c.consoleText("不支持的Vue版本，请使用 Vue2 或 Vue3!","error")}},this.getHandlerName=function(e,t){var n;return"__e"===e?i.getEventHandlerNameFromE(t):c.isEmpty(i.exposedNames)?e:null!==(n=i.exposedNames[e])&&void 0!==n?n:e},this.getEventHandlerNameFromE=function(e){var t="__e",n=e.type,i=e.currentTarget,r=e.target,o=(null==i?void 0:i.dataset)||(null==r?void 0:r.dataset);if(!o)return t;var a=o.eventOpts||o["event-opts"];return a?(a.forEach((function(e){var i=c.head(e),r="^"===i.charAt(0),o="~"===(i=r?i.slice(1):n).charAt(0);i=o?i.slice(1):n;var a,s,u=c.last(e);((a=n)===(s=i)||"regionchange"===s&&("begin"===a||"end"===a))&&(t=c.head(c.head(u)))})),t):t},this.uniVue2Proxy=function(){var e=i.growingIO.dataStore.eventHooks;i.overrideLifeFcEffectsFn(e),e.nativeGrowing()},this.overrideLifeFcEffectsFn=function(e){var t=e.lifeFcEffectsFn;e.lifeFcEffectsFn=function(){for(var e=this,n=[],i=0;arguments.length>i;i++)n[i]=arguments[i];if("Page"!==n[2])return t.apply(this,n);setTimeout((function(){return t.apply(e,n)}),0)}},this.uniVue3Proxy=function(e){var t=i.growingIO,n=t.dataStore.eventHooks,r=t.minipInstance;i.overrideObjectTraverse(n),n.nativeGrowing(),i.overrideGetPageTitle(r),i.addVueMixin(e,n)},this.overrideObjectTraverse=function(e){e.objectTraverse=function(e,t){c.has(e,"methods")&&Object.getOwnPropertyNames(e.methods).forEach((function(n){t(n,e.methods)})),c.has(e,"lifetimes")&&Object.getOwnPropertyNames(e.lifetimes).forEach((function(n){t(n,e.lifetimes)})),c.has(e,"pageLifetimes")&&Object.getOwnPropertyNames(e.pageLifetimes).forEach((function(n){t(n,e.pageLifetimes)})),Object.getOwnPropertyNames(e).forEach((function(n){c.niceTry((function(){return!(null==e?void 0:e.methods[n])&&!(null==e?void 0:e.lifetimes[n])&&!(null==e?void 0:e.pageLifetimes[n])}))||t(n,e)}))}},this.overrideGetPageTitle=function(e){var t=e.getPageTitle;e.getPageTitle=function(){for(var n,i,r,o=[],a=0;arguments.length>a;a++)o[a]=arguments[a];var s=c.isEmpty(o[0])?e.getCurrentPage():o[0];return"page"===(null===(n=null==s?void 0:s.$vm)||void 0===n?void 0:n.mpType)&&(null===(i=null==s?void 0:s.$vm)||void 0===i?void 0:i.__route__)&&(null===(r=null==s?void 0:s.$vm)||void 0===r?void 0:r.gioPageTitle)||t.apply(this,o)}},this.addVueMixin=function(e,t){var n=i;e.mixin({beforeMount:function(){n.proxyMethods(this,t),n.proxyExposedMethods(this,t),n.proxyEmit(this,t)},updated:function(){n.proxyExposedMethods(this,t)}})},this.proxyMethods=function(e,t){var n,i=function(e,n){return c.keys(e).forEach((function(e){var i,r;c.isFunction(n[e])&&Object.defineProperty(n,e,{value:(i=e,r=n[e],c.isFunction(r)&&!t.pageHandlers.includes(i)?function(){for(var e=[],n=0;arguments.length>n;n++)e[n]=arguments[n];return t.customFcEffects(i,r).apply(this,e)}:r),configurable:!0,writable:!0})}))},r=e.$options.methods;r&&i(r,e);var o=null===(n=null==e?void 0:e._)||void 0===n?void 0:n.setupState;o&&i(o,o)},this.proxyExposedMethods=function(e,t){var n,r=null===(n=null==e?void 0:e._)||void 0===n?void 0:n.exposed;i.exposedNames={},r&&c.keys(e.$scope).filter((function(t){return Ce.test(t)&&c.isFunction(e.$scope[t])})).forEach((function(n,r){var o,a=null===(o=e.$scope[n])||void 0===o?void 0:o.value;if(C(a)&&!(a&&e._.updated&&a._GIO_HOOKED_)){var s=i.splicingMethodName(n,a.name);e.$scope[n].value=t.customFcEffects(s,a),e.$scope[n].value._GIO_HOOKED_=!0}}))},this.proxyEmit=function(e,t){var n=e._.emit;e._.emit=function(){for(var e=[],i=0;arguments.length>i;i++)e[i]=arguments[i];return t.customFcEffects(e[0],(function(){})).apply(this,e),n.apply(this,e)}},this.splicingMethodName=function(e,t){return t?e+"#"+t:e},this.pluginVersion="__PLUGIN_VERSION__",c=this.growingIO.utils,this.uniVue=null===(n=null===(t=this.growingIO)||void 0===t?void 0:t.vdsConfig)||void 0===n?void 0:n.uniVue,this.exposedNames={}}},Fe={tap:"onClick",longpress:"onLongPress"},Le=["onShareAppMessage","onShareTimeline","onAddToFavorites","onTabItemTap"],De={name:"gioTaroAdapter",method:function(e){var t=this;this.growingIO=e,this.main=function(){t.initTaroInstance(),t.taroVersion?t.proxyTaro():d.consoleText("未获取到Taro实例或不支持的Taro版本，请检查!","error")},this.initTaroInstance=function(){var e=t.growingIO.vdsConfig,n=e.taro,i=e.taroVue,r=n.Current,o=n.createComponent,a=!r&&o,s=r&&!o;t.taro=n,a?(t.taroVersion="2",d.consoleText("Taro version 2","info")):s&&(t.taroVersion="3",t.taroVue=i,t.taroVue?(t.taroVueVersion=Number(d.head(d.split(t.taroVue.version,"."))),d.consoleText("Taro version 3, Vue version "+t.taroVueVersion,"info")):d.consoleText("Taro version 3","info"))},this.proxyTaro=function(){"2"===t.taroVersion?t.proxyTaro2(t.taro):"3"===t.taroVersion&&t.proxyTaro3()},this.proxyTaro2=function(e){var n=e.createApp,i=e.createComponent;n&&(e.createApp=function(e){var i=n(e);return t.growingIO.dataStore.eventHooks.appOverriding(i),i}),i&&(e.createComponent=function(e,n){var r=i(e,n);return t.injectTaro2Component(r,n),r})},this.injectTaro2Component=function(e,n){var i=(n?"page":"component")+"Overriding",r=t.growingIO,o=r.gioPlatform,a=r.dataStore.eventHooks[i],s=["wx","qq","swan"].includes(o);["my","tt","jd","swan"].includes(o)&&a(e),s&&a(e.methods)},this.proxyTaro3=function(){var e,n,i=t.growingIO.dataStore.eventHooks;if(i.nativeGrowing(["App"]),2===t.taroVueVersion)return i.nativeGrowing(["Page"]),void t.taro3Vue2Proxy();3===t.taroVueVersion&&t.taro3vue3Proxy(),(null===(n=null===(e=t.taro)||void 0===e?void 0:e.hooks)||void 0===n?void 0:n.call)?t.hookTaro3Call():(t.taro3ReactProxy(),i.nativeGrowing(["Page"]))},this.hookTaro3Call=function(){var e=t,n=t.taro.hooks.call;t.defineProperty(t.taro.hooks,"call",(function(){for(var t=[],i=0;arguments.length>i;i++)t[i]=arguments[i];var r=Array.from(t),o=r[0];"getLifecycle"===o&&e.handleTaro3Lifecycle(r);var a=n.apply(this,r);return"modifyPageObject"===o&&e.handleTaro3PageObject(r[1]),"dispatchTaroEvent"===o&&e.handleTaro3DispatchEvent(r[1],r[2]),a}))},this.handleTaro3Lifecycle=function(e){var n=t.growingIO,i=n.minipInstance,r=n.dataStore.eventHooks,o=e[2];if(r.pageHandlers.includes(o)&&!Le.includes(o)){"onLoad"===o&&t.inAppLifecycle&&(t.inAppLifecycle=!1);var a=i.getCurrentPage();a.route&&!t.inAppLifecycle&&d.niceTry((function(){return r.pageEffects.main(a,o,e[1])}))}},this.handleTaro3PageObject=function(e){var n=t.growingIO.dataStore.eventHooks;Le.forEach((function(t){e[t]&&(e[t]=n.lifeFcEffects(t,d.isFunction(e[t])?e[t]:function(){},"Page"))}))},this.handleTaro3DispatchEvent=function(e,n){var i,r,o=t.growingIO.dataStore.eventHooks,a=null===(r=null===(i=t.growingIO.plugins)||void 0===i?void 0:i.gioEventAutoTracking)||void 0===r?void 0:r.main;if(d.isFunction(a)&&o.actionEventTypes.includes(e.type)){var s=e.mpEvent,u=s.currentTarget,l=s.target,c=s.detail;l.id===u.id&&t.processTaro3Event(e,n,a,u,c)}},this.processTaro3Event=function(e,i,r,o,a){try{var s=d.head(i.__handlers[e.type]);if(s){s.oldHandler&&(s=s.oldHandler);var u;u=t.taroVue?t.taro3vue3GetFuncName(s,i):t.taro3reactGetFuncName(s,e,i),r(n(n({},e.mpEvent),{currentTarget:n(n({},o),{detail:a,dataset:n(n({},o.dataset),i.dataset)})}),u)}}catch(e){d.consoleText("Error: "+e,"error")}},this.taro3ReactProxy=function(){var e=document.__proto__.__proto__;Object.defineProperty(e,"dispatchEvent",{value:function(e){var n,i,r=t,o=t.growingIO.dataStore.eventHooks,a=null===(i=null===(n=r.growingIO.plugins)||void 0===n?void 0:n.gioEventAutoTracking)||void 0===i?void 0:i.main;return function(){var t=arguments[0];if(d.isFunction(a)&&o.actionEventTypes.includes(t.type)){var n=t.mpEvent,i=n.currentTarget,s=n.target,u=n.detail;s.id===i.id&&r.processTaro3Event(t,this,a,i,u)}return e.apply(this,arguments)}}(e.dispatchEvent),enumerable:!1,configurable:!0})},this.taro3vue3Proxy=function(){var e=t;t.taroVue.mixin({beforeMount:function(){var t,i,r=this;if((null===(i=null===(t=this._)||void 0===t?void 0:t.props)||void 0===i?void 0:i.tid)&&!d.isEmpty(this._.exposed)){var o=d.head(d.split(this._.props.tid,"?")),a={};d.keys(this._.exposed).forEach((function(e){r._.exposed[e].name&&(a[r._.exposed[e].name]=e)})),e.exposedNames[o]=n({},a)}}})},this.taro3reactGetFuncName=function(e,n,i){var r,o,a,s,u,l,c,g,p,v=d.keys(i).find((function(e){return xe.test(e)})),f=null!==(o=null!==(r=d.niceTry((function(){return i[v][Fe[n.type]]})))&&void 0!==r?r:e.oldHandler)&&void 0!==o?o:e;if(null===(a=null==f?void 0:f.value)||void 0===a?void 0:a.name)return null===(s=null==f?void 0:f.value)||void 0===s?void 0:s.name;if(f.name&&!["handler","invoker"].includes(f.name)){var h=null===(l=null===(u=d.head((""+f).match(Ae)))||void 0===u?void 0:u.replace("return ",""))||void 0===l?void 0:l.replace("(","");return h?null!==(c=d.head(d.drop(d.split(h,"."))))&&void 0!==c?c:f.name:null!=(h=null===(p=null===(g=d.head((""+f).match(Ne)))||void 0===g?void 0:g.replace("return ",""))||void 0===p?void 0:p.replace("(",""))?h:f.name}return t.getAnonymousFunc(i)},this.taro3vue3GetFuncName=function(e,n){var i,r,o,a,s,u,l;if(d.startsWith((""+e.value).replace(" ",""),"function(")){var c=null===(i=d.head((""+e.value).match(qe)))||void 0===i?void 0:i.replace("return ","");try{c?c=c.indexOf("'")>-1?d.head(d.drop(d.split(c,"'"))):d.head(d.drop(d.split(c,'"'))):((c=null===(r=d.head((""+e.value).match(Ve)))||void 0===r?void 0:r.replace("return ",""))||(c=null===(o=d.head((""+e.value).match(He)))||void 0===o?void 0:o.replace("return ","")),c||(c=null===(a=e.value)||void 0===a?void 0:a.name))}catch(e){c=""}if(c){var g,p=c.indexOf(".")>-1?d.head(d.drop(d.split(c,"."))):c;return g=(null===(s=null==n?void 0:n._root)||void 0===s?void 0:s.uid)?d.head(d.split(n._root.uid,"?")):t.growingIO.dataStore.eventHooks.currentPage.getPagePath(),t.exposedNames[g]&&(p=null!==(u=d.niceTry((function(){return t.exposedNames[g][p]})))&&void 0!==u?u:p),p}return t.getAnonymousFunc(n)}return(null===(l=null==e?void 0:e.value)||void 0===l?void 0:l.name)?e.value.name:t.getAnonymousFunc(n)},this.getAnonymousFunc=function(e){var n=t.growingIO.dataStore.eventHooks.currentPage.getPagePath().split("/"),i=n.findIndex((function(e){return e.indexOf("page")>-1}))+1;return(i&&n[i]?n[i]:d.last(n))+"_Func"+(d.startsWith(e.uid,"_")?e.uid:"_"+e.uid)},this.taro3Vue2Proxy=function(){var e=t;t.taroVue.mixin({beforeMount:function(){var t=this,n=this.$options.methods;d.keys(n).forEach((function(n){e.defineProperty(t,n,e.proxyMethods(n,t[n]))}));var i=this._setupState;d.isEmpty(i)||d.keys(i).forEach((function(t){e.defineProperty(i,t,e.proxyMethods(t,i[t]))}))}})},this.proxyMethods=function(e,n){var i=t.growingIO.dataStore.eventHooks;return d.isFunction(n)&&!i.pageHandlers.includes(e)?function(){for(var t=[],r=0;arguments.length>r;r++)t[r]=arguments[r];return i.customFcEffects(e,n).apply(this,t)}:n},this.defineProperty=function(e,t,n){Object.defineProperty(e,t,{writable:!0,enumerable:!0,configurable:!0,value:n})},this.saveFullPage=function(e){var n=function(e){e.forEach((function(e){var i;(null===(i=null==e?void 0:e.ctx)||void 0===i?void 0:i.route)?(t.growingIO.taro3VMs||(t.growingIO.taro3VMs={}),t.growingIO.taro3VMs[e.ctx.route]=e):d.isArray(e.childNodes)&&n(e.childNodes)}))};n(e.childNodes)},this.pluginVersion="__PLUGIN_VERSION__";var i=this.growingIO,r=i.utils,o=i.emitter,a=i.minipInstance;d=r,this.exposedNames={},this.inAppLifecycle=!0,o.on("minipLifecycle",(function(e){var n=e.event;["Page onShow","Page onReady"].includes(n)&&t.taro&&"3"===t.taroVersion&&(t.saveFullPage(document.body),setTimeout((function(){return a.initImpression(a.getCurrentPage())}),0))}))}},Re=[],Me={name:"gioRemaxAdapter",method:function(e){var t,n,i=this;this.growingIO=e,this.main=function(){var e,t;i.remax||(i.remax=null===(t=null===(e=i.growingIO)||void 0===e?void 0:e.vdsConfig)||void 0===t?void 0:t.remax),(0,i.growingIO.dataStore.eventHooks.nativeGrowing)()},this.getTopView=function(e){var t,n,i=null===(t=e.__data__||e.data)||void 0===t?void 0:t.root,r=g.head(i.children);return g.isNumber(r)&&g.has(i,"nodes")?n=i.nodes[g.head(i.children)]:g.isObject(r)&&(n=r),n},this.isPageTopView=function(e,t){var n,r,o,a,s,u=i.getTopView(t),l=g.isArray(null===(n=null==e?void 0:e.memoizedProps)||void 0===n?void 0:n.children)?g.compact(null===(r=null==e?void 0:e.memoizedProps)||void 0===r?void 0:r.children):[];return(null==e?void 0:e.type)===(null==u?void 0:u.type)&&(null===(o=null==e?void 0:e.memoizedProps)||void 0===o?void 0:o.className)===(null===(a=null==u?void 0:u.props)||void 0===a?void 0:a.class)&&l.length===(null===(s=null==u?void 0:u.children)||void 0===s?void 0:s.length)},this.fiberNodeTraverse=function(e,t){return i.isPageTopView(e,t)?e:e.child?i.fiberNodeTraverse(e.child,t):null},this.findRealRoot=function(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.wrapperRef)||void 0===t?void 0:t.current)||void 0===n?void 0:n._reactInternals)&&(e.__data__||e.data)?i.fiberNodeTraverse(e.wrapperRef.current._reactInternals,e):null},this.getHandlerName=function(e){var t=i.growingIO.remaxVMs[i.page];if(p=e,v=Number(g.split(p,"_")[2]),Re=[],t){i.getDataNodePath(t.data);var n=t.fiberNode,r=Re.map((function(e){return function(e,t){var i=g.split(e,"-");i[0];var r=i[1];return g.isArray(t.children)?n=g.compact(t.children)[Number(r)]:g.isObject(t.children)&&(n=t.children),n}(e,n.props||n.memoizedProps)}));if(r.length===Re.length)return g.last(r).props[g.last(g.split(p,"_"))].name}},this.getDataNodePath=function(e){var t=e.children,n=e.nodes,r=null,o=t.find((function(e,t){var i=(g.toString(e)===g.toString(v)||g.toString(e.id)===g.toString(v))&&Object.values((n?n[e]:e).props).includes(p);return i&&Re.unshift((n?e:e.id)+"-"+t),i}));return o?r=g.isNumber(o)&&n?n[o]:o:t.every((function(e,t){return!(n?n[e]:e).children||((r=i.getDataNodePath(n?n[e]:e))&&Re.unshift((n?e:e.id)+"-"+t),!r)})),r},g=this.growingIO.utils,this.remax=null===(n=null===(t=this.growingIO)||void 0===t?void 0:t.vdsConfig)||void 0===n?void 0:n.remax,this.page="",this.growingIO.emitter.on("minipLifecycle",(function(e){var t,n=e.event,r=e.params;if("Page onShow"===n){if(!i.remax)return;var o=r.page,a=i.growingIO,s=a.dataStore,u=a.remaxVMs,l=s.eventHooks.customFcEffects;u||(i.growingIO.remaxVMs={}),o&&!i.growingIO.remaxVMs[o.route]&&(i.growingIO.remaxVMs[o.route]={}),i.page=o.route,o&&!(null===(t=i.growingIO.remaxVMs[o.route])||void 0===t?void 0:t.hooked)&&(g.keys(o).filter((function(e){return e.indexOf("$$REMAX_METHOD")>-1})).forEach((function(e){o[e]=l(e,o[e])})),i.growingIO.remaxVMs[o.route]={hooked:!0,fiberNode:i.findRealRoot(o),data:i.getTopView(o)})}}))}},Be={name:"gioImpressionTracking",method:function(e){var t=this;this.growingIO=e,this.traverseListen=function(e){var n=t.growingIO.minipInstance;if(f.isFunction(null==e?void 0:e.selectAllComponents)){var i=null==e?void 0:e.selectAllComponents(".growing_collect_imp_component");f.isEmpty(i)||i.forEach((function(e){t.traverseListen(e)}))}n.initImpression(e)},this.isEqualRects=function(e,n,i){var r,o,a=(null!==(o=(null!==(r=t.rects[n])&&void 0!==r?r:{})[i])&&void 0!==o?o:[]).map((function(e){return Oe(JSON.stringify(e))})),s=(null!=e?e:[]).map((function(e){return Oe(JSON.stringify(e))}));return j(a,s)},this.getNodeId=function(e){switch(t.growingIO.gioPlatform){case"wx":case"qq":case"ks":case"jd":return e.__wxExparserNodeId__;case"my":return e.$page?e.$page.$id+"-"+e.$id:e.$id;case"swan":return e.route?F(Oe(e.route)):e.nodeId;case"tt":return e.route?F(Oe(e.route)):e.__nodeId__}},this.rectobserve=function(e,n,i){var r=t.growingIO.gioPlatform;if("tt"===r&&n.__nodeId__||"ks"===r&&n.is)return!1;var o=t.getNodeId(n),a=n.route?n:t.growingIO.minipInstance.getCurrentPage(),s=!1;if(a.route){var u=t.isEqualRects(e,a.route,o),l=f.get(t.observerIds,a.route+"."+o+"._disconnected");s=!u||!1!==l}f.isArray(e)&&!f.isEmpty(e)&&!f.isNil(e[0])&&s&&(f.isEmpty(t.rects[a.route])&&(t.rects[a.route]={}),t.rects[a.route][o]=e,t.creatObserver(n,i))},this.main=function(e,n){var i,r,o=t.growingIO.gioPlatform,a=e.route?null===(i=t.growingIO.minipInstance.minip)||void 0===i?void 0:i.createSelectorQuery():null===(r=t.growingIO.minipInstance.minip)||void 0===r?void 0:r.createSelectorQuery().in(e);["ks","qq"].includes(o)?(a.selectAll(".growing_collect_imp").boundingClientRect((function(i){var r=i[0],o=void 0===r?[]:r;o=f.isArray(o)?o:[o],J(o)||t.rectobserve(o,e,n)})),a.exec()):(a.selectAll(".growing_collect_imp").boundingClientRect(),a.exec((function(i){var r=i[0];J(r)||t.rectobserve(r,e,n)})))},this.creatObserver=function(e,n){var i,r,o=t.growingIO,a=o.gioPlatform,s=o.minipInstance,u=((i={})[n]=!0,i);["tb","my"].includes(a)&&f.compareVersion(my.SDKVersion,"2.7.0")>=-1&&(u.dataset=!0);var l=t.getNodeId(e),c=e;!e.isComponent&&e.route&&"component"!==e.mpType||(c=s.getCurrentPage()),t.observerIds[c.route]||(t.observerIds[c.route]={});var d=t.observerIds[c.route][l];d&&!d._disconnected&&d.disconnect();var g=["swan","jd"].includes(a)?null===(r=s.minip)||void 0===r?void 0:r.createIntersectionObserver(e,u):e.createIntersectionObserver(u);g=g.relativeToViewport(),t.observerIds[c.route][l]=g,t.targetObserve(g,c)},this.targetObserve=function(e,n){var i=t.growingIO.vdsConfig.taro;e.observe(".growing_collect_imp",(function(e){if(!f.isEmpty(e)&&e.intersectionRatio>0){var r=e.dataset;i&&f.isTaro3(i)&&(r=t.getTaro3Dataset(n.route,e.id));var o=t.getImpressionProperties(r),a=e.id;if(a){if("once"===r.gioImpType&&f.has(t.sentImps,a))return;t.sentImps[a]=o}o.eventId?t.buildImpEvent(o):f.consoleText("曝光事件格式不正确，事件名只能包含数字、字母和下划线，且不以数字开头!","warn")}}))},this.getImpressionProperties=function(e){var t={eventId:void 0,properties:{}};if(!(null==e?void 0:e.gioImpTrack))return t;if(t.eventId=e.gioImpTrack,f.has(e,"gioImpAttrs"))t.properties=f.niceTry((function(){return f.isObject(e.gioImpAttrs)?e.gioImpAttrs:JSON.parse(e.gioImpAttrs)})),t.items=f.niceTry((function(){return f.isObject(e.gioImpItems)?e.gioImpItems:JSON.parse(e.gioImpItems)}));else{var n=/^gioTrack(.+)/;for(var i in e){var r=void 0,o=i.match(n);o&&"track"!==(r=f.lowerFirst(o[1]))&&(t.properties[r]=e[i])}}return t.properties=f.limitObject(t.properties),t.items=f.limitObject(t.items),/^\w+$/.test(t.eventId)&&!Number.isInteger(Number(f.head(t.eventId.split(""))))||(t.eventId=null,t={}),t},this.getTaro3Dataset=function(e,n){var i,r=null===(i=t.growingIO)||void 0===i?void 0:i.taro3VMs[e];if(!r)return!1;var o={},a=function(e){e.some((function(e){var t;return e.uid!==n&&e.sid!==n||-1>=(null===(t=e.props)||void 0===t?void 0:t.class.indexOf("growing_collect_imp"))||f.isEmpty(e.dataset)?!!Array.isArray(e.childNodes)&&a(e.childNodes):(o=e.dataset,!0)}))};return a(r.childNodes),o},this.buildImpEvent=function(e){var i=e.eventId,r=e.properties,o=e.items,a=t.growingIO.dataStore,s=a.eventContextBuilder,u=a.eventInterceptor,l=a.eventHooks;u(n({eventType:"CUSTOM",pageShowTimestamp:l.currentPage.time,eventName:i,attributes:r,resourceItem:o},s()))},f=this.growingIO.utils,this.observerIds={},this.rects={},this.sentImps={};var i=this.growingIO,r=i.emitter,o=i.minipInstance;this.growingIO.updateImpression=function(e){e||(e=o.getCurrentPage()),o.initImpression(e)},r.on("minipLifecycle",(function(e){var n,i=e.event,r=e.params,o=t.growingIO.minipInstance;if("Page onShowEnd"===i){var a=o.getCurrentPage();t.traverseListen(a)}if(["Page onHide","Page onUnload"].includes(i)){var s=r.page.route;Object.values(null!==(n=t.observerIds[s])&&void 0!==n?n:{}).forEach((function(e){return e.disconnect()}))}}))}},Ue={name:"gioEventAutoTracking",method:function(e){var t=this;this.growingIO=e,this.main=function(e,n){var i,r,o=t.growingIO,a=o.vdsConfig,s=o.platformConfig,u=o.plugins,l=o.emitter;if(!(!a.autotrack||!n||h.get(e,"currentTarget.dataset.growingIgnore")||h.get(e,"target.dataset.growingIgnore")||!h.get(e,"target.dataset.growingTrack")&&"autoplay"===h.get(e,"detail.source")||e.type===(null===(i=t.prevEvent)||void 0===i?void 0:i.type)&&10>Math.abs(Number(e.timeStamp)-Number(null===(r=t.prevEvent)||void 0===r?void 0:r.timeStamp))||a.taro&&["eh"].includes(n)||a.cml&&["_cmlEventProxy","onclick","blurEvent","handleDetail"].includes(n))){t.prevEvent=e,a.uniVue&&(n=null==u?void 0:u.gioUniAppAdapter.getHandlerName(n,e)),a.remax&&n.indexOf("$$REMAX_METHOD")>-1&&(n=null==u?void 0:u.gioRemaxAdapter.getHandlerName(n)),a.debug&&console.log("Action：",e.type,Date.now()),l.emit("onComposeBefore",{event:n,params:null!=e?e:{}});var c=s.listeners.actions;c.click.includes(e.type)?t.buildClickEvent(e,n):c.change.includes(e.type)?t.buildChangeEvent(e,n):c.submit.includes(e.type)&&t.buildSubmitEvent(e,n)}},this.getNodeXpath=function(e,n){var i=t.growingIO,r=i.gioPlatform,o=i.vdsConfig,a=(e.currentTarget||e.target).id;if((!a||"swan"===r&&/^_[0-9a-f]+/.test(a)||le(o.taro)&&/^_n_[0-9]+$/.test(a))&&(a=""),!o.octopus||(n=e.handler,/^bound .*/.test(n)&&(n=n.replace("bound ","")),/^t[0-9]+$/.test(a)&&(a=""),a&&!n&&(n="anonymousFunc"),a||n))return a+"#"+n},this.buildClickEvent=function(e,i){var r,o,a,s=t.getNodeXpath(e,i);if(s){var u=t.growingIO,l=u.dataStore,c=l.eventContextBuilder,d=l.eventInterceptor,g=l.eventHooks,p=u.gioEnvironment,v=e.currentTarget||e.target,f=void 0;h.has(null==v?void 0:v.dataset,"index")&&""!==(null===(r=null==v?void 0:v.dataset)||void 0===r?void 0:r.index)&&(f=Number(v.dataset.index),Number.isNaN(f)&&(f=-1)),d(n({eventType:"saas"===p&&e.type.includes("long")?"lngprss":"VIEW_CLICK",pageShowTimestamp:g.currentPage.time,element:[{xpath:s,index:f,textValue:null===(o=null==v?void 0:v.dataset)||void 0===o?void 0:o.title,hyperlink:null===(a=null==v?void 0:v.dataset)||void 0===a?void 0:a.src}]},c()))}},this.buildTabClickEvent=function(e){var i=t.growingIO.dataStore,r=i.eventContextBuilder,o=i.eventInterceptor,a=i.eventHooks;o(n({eventType:"VIEW_CLICK",pageShowTimestamp:a.currentPage.time,element:[{xpath:"#onTabItemTap",textValue:e.text,index:e.index,hyperlink:h.toString(e.pagePath)}]},r()))},this.buildChangeEvent=function(e,i){var r,o,a=t.getNodeXpath(e,i);if(a){var s=t.growingIO.dataStore,u=s.eventContextBuilder,l=s.eventInterceptor,c=s.eventHooks,d=e.currentTarget||e.target,g=n({eventType:"VIEW_CHANGE",pageShowTimestamp:c.currentPage.time,element:{xpath:a}},u()),p=h.get(e,"detail.value")||h.get(e,"target.attr.value");((null===(r=null==d?void 0:d.dataset)||void 0===r?void 0:r.growingTrack)||(null===(o=null==d?void 0:d.dataset)||void 0===o?void 0:o.growingtrack))&&(h.isNil(p)||(g.element.textValue=h.toString(p))),g.element=[g.element],l(g)}},this.buildSubmitEvent=function(e,i){var r=t.getNodeXpath(e,i);if(r){var o=t.growingIO.dataStore,a=o.eventContextBuilder,s=o.eventInterceptor,u=o.eventHooks;s(n({eventType:"FORM_SUBMIT",pageShowTimestamp:u.currentPage.time,element:[{xpath:r}]},a()))}},h=this.growingIO.utils,this.prevEvent={}}},Ge={name:"gioCustomTracking",method:function(e){var t=this;this.growingIO=e,this.getValidResourceItem=function(e){if(e&&m.isObject(e)&&e.id&&e.key){var t={id:m.isString(e.id)?e.id:m.toString(e.id),key:m.isString(e.key)?e.key:m.toString(e.key)};return e.attributes&&(t.attributes=e.attributes),t}},this.getDynamicAttributes=function(e){return m.isNil(e)||m.keys(e).forEach((function(t){m.isFunction(e[t])?e[t]=e[t]():m.isArray(e[t])||(e[t]=m.toString(e[t]))})),e},this.buildCustomEvent=function(e,i,r){m.eventNameValidate(e,(function(){var o,a=t.growingIO.dataStore,s=a.eventContextBuilder,u=a.eventInterceptor,l=a.eventHooks;u(n({eventType:"CUSTOM",eventName:e,pageShowTimestamp:null===(o=null==l?void 0:l.currentPage)||void 0===o?void 0:o.time,attributes:m.limitObject(t.getDynamicAttributes(m.isObject(i)&&!m.isEmpty(i)?i:void 0)),resourceItem:m.limitObject(t.getValidResourceItem(r))},s()))}))},this.buildUserAttributesEvent=function(e){var i=t.growingIO.dataStore,r=i.eventContextBuilder,o=i.eventInterceptor,a=i.lastVisitEvent,s=n({eventType:"LOGIN_USER_ATTRIBUTES",attributes:m.limitObject(e)},r());s.path||(s.path=a.path,s.query=a.query,s.title=a.title),o(s)},m=this.growingIO.utils}},$e={name:"gioCompress",method:function(e){var t=this;this.growingIO=e,this.compressToUTF16=function(e){var n=t;return null===e?"":t._compress(e,15,(function(e){return n.f(e+32)}))+" "},this.f=String.fromCharCode,this._compress=function(e,t,n){if(null===e)return"";var i,r,o,a={},s={},u="",l="",c="",d=2,g=3,p=2,v=[],f=0,h=0;for(o=0;o<e.length;o+=1)if(u=e.charAt(o),{}.hasOwnProperty.call(a,u)||(a[u]=g++,s[u]=!0),l=c+u,{}.hasOwnProperty.call(a,l))c=l;else{if({}.hasOwnProperty.call(s,c)){if(256>c.charCodeAt(0)){for(i=0;p>i;i++)f<<=1,h===t-1?(h=0,v.push(n(f)),f=0):h++;for(r=c.charCodeAt(0),i=0;8>i;i++)f=f<<1|1&r,h===t-1?(h=0,v.push(n(f)),f=0):h++,r>>=1}else{for(r=1,i=0;p>i;i++)f=f<<1|r,h===t-1?(h=0,v.push(n(f)),f=0):h++,r=0;for(r=c.charCodeAt(0),i=0;16>i;i++)f=f<<1|1&r,h===t-1?(h=0,v.push(n(f)),f=0):h++,r>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[c]}else for(r=a[c],i=0;p>i;i++)f=f<<1|1&r,h===t-1?(h=0,v.push(n(f)),f=0):h++,r>>=1;0==--d&&(d=Math.pow(2,p),p++),a[l]=g++,c=u+""}if(""!==c){if({}.hasOwnProperty.call(s,c)){if(256>c.charCodeAt(0)){for(i=0;p>i;i++)f<<=1,h===t-1?(h=0,v.push(n(f)),f=0):h++;for(r=c.charCodeAt(0),i=0;8>i;i++)f=f<<1|1&r,h===t-1?(h=0,v.push(n(f)),f=0):h++,r>>=1}else{for(r=1,i=0;p>i;i++)f=f<<1|r,h===t-1?(h=0,v.push(n(f)),f=0):h++,r=0;for(r=c.charCodeAt(0),i=0;16>i;i++)f=f<<1|1&r,h===t-1?(h=0,v.push(n(f)),f=0):h++,r>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[c]}else for(r=a[c],i=0;p>i;i++)f=f<<1|1&r,h===t-1?(h=0,v.push(n(f)),f=0):h++,r>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(r=2,i=0;p>i;i++)f=f<<1|1&r,h===t-1?(h=0,v.push(n(f)),f=0):h++,r>>=1;for(;;){if(f<<=1,h===t-1){v.push(n(f));break}h++}return v.join("")}}};const Ke={};function Qe(e,t,n){var i=e;t.map((function(e,r){i[e]=r==t.length-1?n:i[e]||{},i=i[e]}))}Qe(Ke,["plugins","gioChameleonAdapter"],{name:"gioChameleonAdapter",method:function(e){var t,n,i=this;this.growingIO=e,this.main=function(){var e=i.growingIO,t=e.vdsConfig,n=e.dataStore.eventHooks;i.cml||(i.cml=null==t?void 0:t.cml);var r=i.cml.createApp,o=i.cml.createPage,a=i.cml.createComponent;i.cml.createApp=function(e){return r(n.appOverriding(e))},i.cml.createPage=function(e){return o(n.pageOverriding(e))},i.cml.createComponent=function(e){return a(n.componentOverriding(e))}},this.cml=null===(n=null===(t=this.growingIO)||void 0===t?void 0:t.vdsConfig)||void 0===n?void 0:n.cml}}),Qe(Ke,["plugins","gioCompress"],$e),Qe(Ke,["plugins","gioCustomTracking"],Ge),Qe(Ke,["plugins","gioEventAutoTracking"],Ue),Qe(Ke,["plugins","gioImpressionTracking"],Be),Qe(Ke,["plugins","gioRemaxAdapter"],Me),Qe(Ke,["plugins","gioTaroAdapter"],De),Qe(Ke,["plugins","gioUniAppAdapter"],je),Qe(Ke,["plugins","gioWepyAdapter"],{name:"gioWepyAdapter",method:function(e){var t,n,i=this;this.growingIO=e,this.main=function(){var e,t;i.wepy||(i.wepy=null===(t=null===(e=i.growingIO)||void 0===e?void 0:e.vdsConfig)||void 0===t?void 0:t.wepy),i.proxyWepy(i.wepy)},this.proxyWepy=function(e){var t=i.growingIO.dataStore.eventHooks,n=t.appOverriding,r=t.pageOverriding,o=t.componentOverriding,a=e.app,s=e.page,u=e.component;e.app=function(e,t){return a(n(e),t)},e.page=function(e,t){return s(r(e),t)},e.component=function(e,t){return u(o(e),t)}},this.wepy=null===(n=null===(t=this.growingIO)||void 0===t?void 0:t.vdsConfig)||void 0===n?void 0:n.wepy}});var We=function(e){var t=this;this.growingIO=e,this.innerPluginInit=function(){G(Ke.plugins).forEach((function(e){var n=Ke.plugins[e],i=n.name,r=n.method;t.pluginItems.find((function(e){return e.name===i}))||t.pluginItems.push({name:D(i||e),method:r||function(e){}})})),J(t.pluginItems)||t.installAll()},this.install=function(e,n,i){var r,o=n||t.pluginItems.find((function(t){return t.name===e}));if(null===(r=t.growingIO)||void 0===r?void 0:r.plugins[e])return Y("重复加载插件 "+e+" 或插件重名，已跳过加载!","warn"),!1;if(!o)return Y("插件加载失败!不存在名为 "+e+" 的插件!","error"),!1;try{return t.growingIO.plugins[e]=new o.method(t.growingIO,i),"cdp"===t.growingIO.gioEnvironment&&n&&Y("加载插件："+e,"info"),!0}catch(e){return Y("插件加载异常："+e,"error"),!1}},this.installAll=function(e){(e||t.pluginItems).forEach((function(n){return t.install(n.name,e?n:void 0,n.options)}))},this.uninstall=function(e){var n;W(t.pluginItems,e);var i=W(null===(n=t.growingIO)||void 0===n?void 0:n.plugins,e);return i||Y("卸载插件 "+e+" 失败!","error"),i},this.uninstallAll=function(){t.pluginItems.forEach((function(e){return t.uninstall(e.name)}))},this.lifeError=function(e,t){return Y("插件执行错误 "+e.name+" "+t,"error")},this.onComposeBefore=function(e){t.pluginItems.forEach((function(n){var i,r=null===(i=t.growingIO.plugins[n.name])||void 0===i?void 0:i.onComposeBefore;if(r&&C(r))try{r(e)}catch(e){t.lifeError(n,e)}}))},this.onComposeAfter=function(e){t.pluginItems.forEach((function(n){var i,r=null===(i=t.growingIO.plugins[n.name])||void 0===i?void 0:i.onComposeAfter;if(r&&C(r))try{r(e)}catch(e){t.lifeError(n,e)}}))},this.onSendBefore=function(e){t.pluginItems.forEach((function(n){var i,r=null===(i=t.growingIO.plugins[n.name])||void 0===i?void 0:i.onSendBefore;if(r&&C(r))try{r(e)}catch(e){t.lifeError(n,e)}}))},this.onSendAfter=function(e){t.pluginItems.forEach((function(n){var i,r=null===(i=t.growingIO.plugins[n.name])||void 0===i?void 0:i.onSendAfter;if(r&&C(r))try{r(e)}catch(e){t.lifeError(n,e)}}))},this.pluginItems=[],this.growingIO.emitter.on("onComposeBefore",this.onComposeBefore),this.growingIO.emitter.on("onComposeAfter",this.onComposeAfter),this.growingIO.emitter.on("onSendBefore",this.onSendBefore),this.growingIO.emitter.on("onSendAfter",this.onSendAfter)},ze=function(){function e(e){var t,n=this;this.growingIO=e,this.initUserInfo=function(){var e,t=n.growingIO.minipInstance,i=[n.uidStorageName,n.userIdStorageName,n.userKeyStorageName,n.gioIdStorageName],r=null!==(e=Ie(t,i))&&void 0!==e?e:[];["_uid","_userId","_userKey","_gioId"].forEach((function(e,t){n[e]=r[t],"_uid"!==e||n[e]||(n.uid=ie())}))},this.saveUserInfo=function(){var e=n.growingIO.minipInstance;ye(e,[{key:n.uidStorageName,value:n.uid},{key:n.userIdStorageName,value:n.userId},{key:n.userKeyStorageName,value:n.userKey},{key:n.gioIdStorageName,value:n.gioId}])};var i=this.growingIO.inPlugin;this.uidStorageName=i?"_growing_plugin_uid_":"_growing_uid_",this.userIdStorageName=i?"_growing_plugin_userId_":"_growing_userId_",this.userKeyStorageName=i?"_growing_plugin_userKey_":"_growing_userKey_",this.gioIdStorageName=i?"_growing_plugin_gioId_":"_growing_gioId_",this._sessionId=ie(),this._uid=void 0,this._userId=void 0,this._userKey=void 0,this._gioId=void 0,"quickapp"!==(null===(t=this.growingIO)||void 0===t?void 0:t.gioPlatform)&&this.initUserInfo()}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this._sessionId||(this._sessionId=ie()),this._sessionId},set:function(e){var t=this._sessionId;this._sessionId=e||ie(),t!==this._sessionId&&this.growingIO.emitter.emit("SESSIONID_UPDATE",{newSessionId:this._sessionId,oldSessionId:t})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid},set:function(e){var t=this._uid;this._uid=e,t!==this._uid&&(this.growingIO.minipInstance.setStorage(this.uidStorageName,this._uid),this.growingIO.emitter.emit("UID_UPDATE",{newUId:e,oldUId:t}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this._userId},set:function(e){var t=this._userId;this._userId=e,t!==this._userId&&(this.growingIO.minipInstance.setStorage(this.userIdStorageName,this._userId),this.growingIO.emitter.emit("USERID_UPDATE",{newUserId:e,oldUserId:t})),e&&(this.gioId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userKey",{get:function(){return this._userKey},set:function(e){var t=this._userKey;this._userKey=e,t!==this._userKey&&(this.growingIO.minipInstance.setStorage(this.userKeyStorageName,this._userKey),this.growingIO.emitter.emit("USERKEY_UPDATE",{newUserKey:e,oldUserKey:t}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gioId",{get:function(){return this._gioId},set:function(e){var t=this._gioId;this._gioId=e,t!==this._gioId&&(this.growingIO.minipInstance.setStorage(this.gioIdStorageName,this._gioId),this.growingIO.emitter.emit("GIOID_UPDATE",{newGioId:e,oldGioId:t}))},enumerable:!1,configurable:!0}),e}(),Je={scnPrefix:"",appHandlers:["onLaunch","onShow","onHide","onError","onPageNotFound"],pageHandlers:["onLoad","onShow","onReady","onHide","onUnload","onShareAppMessage","onTabItemTap"],actionEventTypes:["onclick","tap","onTap","longpress","longTap","blur","change","onChange","submit","confirm","getuserinfo","getphonenumber","contact"],canHook:!0,hooks:{App:!0,Page:!0,Component:!0,Behavior:!0},listeners:{app:{appLaunch:"onLaunch",appShow:"onShow",appClose:"onHide"},page:{pageLoad:"onLoad",pageShow:"onShow",pageReady:"onReady",pageHide:"onHide",pageUnload:"onUnload",tabTap:"onTabItemTap",shareApp:"onShareAppMessage"},actions:{click:["onclick","tap","longpress","longTap","getuserinfo","getphonenumber","contact"],change:["blur","change","confirm"],submit:["submit"]}}},Xe=n(n({},Je),{listeners:n({},Je.listeners),name:"JingDong",platform:"jdp",scnPrefix:"jd_"}),Ze=n(n({},Je),{listeners:n({},Je.listeners),name:"KuaiShou",platform:"kuaishoup",scnPrefix:"ks_"}),Ye=n(n({},Je),{listeners:n({},Je.listeners),name:"Alipay",platform:"alip",scnPrefix:"alip_",hooks:n(n({},Je.hooks),{Behavior:!1})}),et=n(n({},Je),{listeners:n({},Je.listeners),name:"QQ",platform:"qq",scnPrefix:"qq_"});et.pageHandlers=o(o([],Je.pageHandlers),["onAddToFavorites"]),et.listeners.page.addFavorites="onAddToFavorites";var nt=n(n({},Je),{listeners:n({},Je.listeners),name:"Baidu",platform:"baidup",scnPrefix:"baidup_"}),it=n(n({},Je),{listeners:n({},Je.listeners),name:"Bytedance",platform:"bytedance",scnPrefix:"bytedance_"}),rt=n(n({},Je),{listeners:n({},Je.listeners),name:"Weixin",platform:"MinP"});rt.pageHandlers=o(o([],Je.pageHandlers),["onShareTimeline","onAddToFavorites"]),rt.listeners.page=n(n({},Je.listeners.page),{shareTime:"onShareTimeline",addFavorites:"onAddToFavorites"});var ot=pe(),at=ee((function(){var e={jd:Xe,ks:Ze,my:Ye,qq:et,swan:nt,tt:it,wx:rt}[ot];return e.canHook=!1,e})),st=function(e){var t=this;this.growingIO=e,this.minip=ce("framework"),this.hookSetTitle=function(){var e,n=null===(e=t.minip)||void 0===e?void 0:e.setNavigationBarTitle,i=t;n&&Object.defineProperty(t.minip,"setNavigationBarTitle",{writable:!0,enumerable:!0,configurable:!0,value:function(){if(i.growingIO.gioSDKInitialized){var e=i.getCurrentPath(),t=(arguments[0]||{}).title;i.growingIO.dataStore.eventHooks.currentPage.configuredTitle[e]=t}return n.apply(this,arguments)}})},this.navigateTo=function(e){var n;return null===(n=t.minip)||void 0===n?void 0:n.navigateTo(e)},this.switchTab=function(e){var n;null===(n=t.minip)||void 0===n||n.switchTab(e)},this.navigateToMiniProgram=function(e){var n;return null===(n=t.minip)||void 0===n?void 0:n.navigateToMiniProgram(e)},this.getImageInfo=function(e){var n,i=e.src,r=e.success,o=e.fail,a=e.complete;return null===(n=t.minip)||void 0===n?void 0:n.getImageInfo({src:i,success:r,fail:o,complete:a})},this.initImpression=function(e){var n,i;null===(i=null===(n=t.growingIO.plugins)||void 0===n?void 0:n.gioImpressionTracking)||void 0===i||i.main(e,"observeAll")},this.getCurrentPage=function(){return ee((function(){return N(getCurrentPages())}))||{}},this.getCurrentPath=function(){var e=t.getCurrentPage();return(null==e?void 0:e.route)||(null==e?void 0:e.uri)||(null==e?void 0:e.__route__)||""},this.getPageTitle=function(e){var n,i,r,o,a,s,u,l,c=pe(),d="",g=de(c);"string"===X(g)&&(g=null!==(n=ee((function(){return JSON.parse(g)})))&&void 0!==n?n:{});var p,v=(null==e?void 0:e.data)||e.$data||{};if((d=_(null==v?void 0:v.gioPageTitle)?null==v?void 0:v.gioPageTitle:"")||ee((function(){var t,n,i=ge(c);i&&(p=i[e.route+".json"]||{},d=(null==p?void 0:p.navigationBarTitleText)||(null===(n=null===(t=null==p?void 0:p.mod)||void 0===t?void 0:t.exports)||void 0===n?void 0:n.navigationBarTitleText))})),!d&&g){var f=t.growingIO.dataStore.eventHooks.appEffects.enterParams;if(e.route||J(f)||(e.route=f.path||"",d=e.route?t._getTitleFromTabBar(g,e.route):""),!d&&(p=x(g.pages)?null!==(i=g.pages.find((function(t){return t.path===e.route})))&&void 0!==i?i:{}:g.page||{})){var h=p[e.route]||p[e.route+".html"]||p;d=(null==h?void 0:h.navigationBarTitleText)||(null===(r=null==h?void 0:h.window)||void 0===r?void 0:r.navigationBarTitleText)}d||(d=t._getTitleFromTabBar(g,e.route))}return d||(d=["wx","tt"].includes(c)?null===(s=null===(a=null===(o=g||global||$global)||void 0===o?void 0:o.global)||void 0===a?void 0:a.window)||void 0===s?void 0:s.navigationBarTitleText:null===(l=null===(u=g||global||$global)||void 0===u?void 0:u.window)||void 0===l?void 0:l.navigationBarTitleText),te(d)},this._getTitleFromTabBar=function(e,t){var n,i,r=null===(i=null===(n=null==e?void 0:e.tabBar)||void 0===n?void 0:n.list)||void 0===i?void 0:i.find((function(e){return e.pagePath===t||e.pagePath===t+".html"}));return(null==r?void 0:r.text)||""},this.getStorageSync=function(e){var n;return null===(n=t.minip)||void 0===n?void 0:n.getStorageSync(e)},this.getStorage=function(e){return new Promise((function(n){var i;null===(i=t.minip)||void 0===i||i.getStorage({key:e,success:function(e){var t=e.data;return n(t)},fail:function(){return n("")}})}))},this.setStorageSync=function(e,n){var i;null===(i=t.minip)||void 0===i||i.setStorageSync(e,n)},this.setStorage=function(e,n){var i;null===(i=t.minip)||void 0===i||i.setStorage({key:e,data:n})},this.removeStorageSync=function(e){var n;null===(n=t.minip)||void 0===n||n.removeStorageSync(e)},this.removeStorage=function(e){var n;null===(n=t.minip)||void 0===n||n.removeStorage(e)},this.getNetworkType=function(){return i(t,void 0,void 0,(function(){var e,t=this;return r(this,(function(n){switch(n.label){case 0:return e=this,[4,new Promise((function(n){var i;null===(i=t.minip)||void 0===i||i.getNetworkType({success:function(t){e.network=t,n(t)},fail:function(){return n(null)}})}))];case 1:return[2,n.sent()]}}))}))},this.request=function(e){var n,i=e.url,r=e.data,o=e.header,a=e.timeout,s=e.method,u=e.success,l=e.fail,c=e.complete,d=null===(n=t.minip)||void 0===n?void 0:n.request({url:i,data:r,header:o,headers:o,timeout:a,method:s,success:u,fail:l,complete:c}),g=setTimeout((function(){null==d||d.abort(),clearTimeout(g),g=null}),(a||1e4)+10);return d},this.getSystemInfo=function(){return i(t,void 0,void 0,(function(){var e,t=this;return r(this,(function(n){switch(n.label){case 0:return e=this,[4,new Promise((function(n){var i;null===(i=t.minip)||void 0===i||i.getSystemInfo({success:function(t){e.systemInfo=t,n(t)},fail:function(){return n(null)}})}))];case 1:return[2,n.sent()]}}))}))},this.getSetting=function(){return new Promise((function(e){var n;null===(n=t.minip)||void 0===n||n.getSetting({success:e,fail:e})}))};var n=this.growingIO.platformConfig,o=n.platform,a=n.scnPrefix;this.platform=o,this.scnPrefix=a,this.getNetworkType().then((function(){var e;return null===(e=t.growingIO.dataStore)||void 0===e?void 0:e.eventReleaseInspector()})),this.getSystemInfo().then((function(){var e;return null===(e=t.growingIO.dataStore)||void 0===e?void 0:e.eventReleaseInspector()}))},ut=function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.hookSetTitle(),n}return t(n,e),n}(st),lt=function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.hookSetTitle(),n}return t(n,e),n}(st),ct=function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.hookSetTitle=function(){var e,t=null===(e=n.minip)||void 0===e?void 0:e.setNavigationBar,i=n;t&&Object.defineProperty(n.minip,"setNavigationBar",{writable:!0,enumerable:!0,configurable:!0,value:function(){if(i.growingIO.gioSDKInitialized){var e=i.getCurrentPath(),n=(arguments[0]||{}).title;i.growingIO.dataStore.eventHooks.currentPage.configuredTitle[e]=n}return t.apply(this,arguments)}})},n.initImpression=function(e){var t,i;null===(i=null===(t=n.growingIO.plugins)||void 0===t?void 0:t.gioImpressionTracking)||void 0===i||i.main(e,"selectAll")},n.getStorageSync=function(e){return my.getStorageSync({key:e}).data},n.setStorageSync=function(e,t){var i;null===(i=n.minip)||void 0===i||i.setStorageSync({key:e,data:t})},n.hookSetTitle(),n}return t(n,e),n}(st),dt=function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.hookSetTitle(),n}return t(n,e),n}(st),gt=function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.initImpression=function(e){var t,i;null===(i=null===(t=n.growingIO.plugins)||void 0===t?void 0:t.gioImpressionTracking)||void 0===i||i.main(e,"selectAll")},n.hookSetTitle(),n}return t(n,e),n}(st),pt=function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.hookSetTitle(),n}return t(n,e),n}(st),vt={wx:function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.hookSetTitle(),n}return t(n,e),n}(st),swan:gt,my:ct,qq:dt,tt:pt,ks:lt,jd:ut}[pe()],ft={},ht={}.hasOwnProperty;function mt(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function It(e){try{return encodeURIComponent(e)}catch(e){return null}}ft.stringify=function(e,t){t=t||"";var n,i,r=[];for(i in"string"!=typeof t&&(t="?"),e)if(ht.call(e,i)){if((n=e[i])||null!=n&&!isNaN(n)||(n=""),i=It(i),n=It(n),null===i||null===n)continue;r.push(i+"="+n)}return r.length?t+r.join("&"):""},ft.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,i={};t=n.exec(e);){var r=mt(t[1]),o=mt(t[2]);null===r||null===o||r in i||(i[r]=o)}return i};var yt=function(e){var t=this;this.growingIO=e,this.main=function(e){var i,r=t.growingIO,o=r.sdkVersion,a=r.vdsConfig,s=r.platformConfig,u=r.minipInstance,l=r.userStore,c=r.dataStore,d=c.scene,g=c.eventHooks.currentPage,p=c.locationData,v=u.systemInfo,f=void 0===v?{}:v,h=u.network,m=void 0===h?{}:h,I=f.brand,y=f.model,w=f.platform,S=f.language,O=f.version,b=g.getPagePath(),T={appChannel:"scn:"+(d||"NA"),appVersion:a.version,dataSourceId:a.dataSourceId,deviceBrand:I,deviceId:l.uid,deviceModel:y,deviceType:ae(w,s.name),domain:a.appId,gioId:l.gioId,language:S,latitude:null==p?void 0:p.latitude,longitude:null==p?void 0:p.longitude,networkState:(null===(i=null==m?void 0:m.networkType)||void 0===i?void 0:i.result)||(null==m?void 0:m.networkType)||(null==m?void 0:m.type)||(null==m?void 0:m.subtype),operatingSystem:ae(w,s.name),path:b,platform:s.platform,platformVersion:s.name+(O?" "+O:""),query:b?g.getPageQuery():"",screenHeight:re(f),screenWidth:oe(f),sdkVersion:o,sessionId:l.sessionId,title:g.getPageTitle(),timestamp:Date.now(),userId:l.userId};return a.enableIdMapping&&(T.userKey=l.userKey),J(a.ignoreFields)||a.ignoreFields.forEach((function(e){W(T,e)})),J(e)?T:n(n({},T),e)}},wt=function(e){var t=this;this.growingIO=e,this.enterParams={},this.main=function(e,i){var r,o,a=Date.now(),s=t.growingIO,u=s.emitter,l=s.userStore,c=s.vdsConfig,d=s.platformConfig,g=s.uploader,p=s.dataStore,v=s.dataStore,f=v.keepAlive,h=v.lastCloseTime,m=v.eventHooks,I=v.saveStorageInfo;u.emit("minipLifecycle",{event:"App "+e,timestamp:a,params:null!==(r=i[0])&&void 0!==r?r:{}}),c.debug&&console.log("App:",e,a);var y=d.listeners.app;switch(u.emit("onComposeBefore",{event:"App "+e,params:null!==(o=i[0])&&void 0!==o?o:{}}),e){case y.appLaunch:t.enterParams=n({},i[0]);break;case y.appCreate:case y.appShow:var w=t.enterParamsParse(i[0]),S=w.path,O=w.query,b=w.referralPage;h?(Date.now()-h>f||p.lastScene&&p.scene!==p.lastScene)&&(l.sessionId="",m.currentPage.time=void 0,t.buildVisitEvent({path:S,query:O,referralPage:b})):(t.growingIO.dataStore.lastVisitEvent={path:S,query:O,referralPage:b},t.buildVisitEvent({path:S,query:O,referralPage:b}));break;case y.appClose:p.lastScene=p.scene,p.lastCloseTime=Date.now(),I(),l.saveUserInfo(),t.buildCloseEvent(),c.forceLogin||g.initiateRequest(!0)}},this.enterParamsParse=function(e){var n,i=t.growingIO,r=i.gioPlatform,o=i.minipInstance,a=i.dataStore,s="",u="",l="",c=function(e,t){void 0===t&&(t={}),s=e,u=G(t).map((function(e){return e+"="+t[e]})).join("&")};if("quickapp"!==r&&o.minip.canIUse("getEnterOptionsSync")){var d=o.minip.getEnterOptionsSync()||{},g=d.path,p=d.query,v=d.scene,f=d.referrerInfo||d.refererInfo,h=e.query||p;if(c(e.path||g,h),l=(null==f?void 0:f.appId)||(null===(n=null==e?void 0:e.referrerInfo)||void 0===n?void 0:n.appId)||"",a.scene=e.scene||v,!J(f)&&k(null==f?void 0:f.extraData)){var m=[];$(f.extraData,(function(e,t){!U(h,t)&&["string","number","boolean"].includes(X(e))&&m.push(t+"="+e)}));var I=m.join("&");u=u&&I?u+"&"+I:u||I}}else g=e.path,p=e.query,f=e.referrerInfo,c(g,p),l=(null==f?void 0:f.appId)||"",t.parseScene(e);return{path:s,query:u,referralPage:l}},this.parseScene=function(e){var n,i,r=t.growingIO,o=r.minipInstance,a=r.gioPlatform,s=r.dataStore;if("quickapp"===a){var u=o.getAppSource(),l=u.extra,c=u.type;i=(null==l?void 0:l.scene)||c}else J(e)||((null===(n=null==e?void 0:e.query)||void 0===n?void 0:n.wxShoppingListScene)?i=e.query.wxShoppingListScene:(null==e?void 0:e.scene)?i=e.scene:s.scene="NA");s.scene=i},this.buildVisitEvent=function(e){var i=t.growingIO.dataStore,r=i.eventContextBuilder,o=i.eventInterceptor,a=(null==e?void 0:e.query)||(null==e?void 0:e.q)||"";o(n({eventType:"VISIT"},r({path:(null==e?void 0:e.path)||(null==e?void 0:e.p)||"",query:"string"===X(a)?a:we(a),referralPage:e.referralPage||""})))},this.buildCloseEvent=function(){var e=t.growingIO.dataStore,i=e.eventContextBuilder;(0,e.eventInterceptor)(n({eventType:"APP_CLOSED"},i()))}},St=function(){function e(e){var t=this;this.growingIO=e,this.getPagePath=function(){var e,n,i,r=t.growingIO,o=r.minipInstance,a=r.inPlugin,s=r.dataStore,u=r.vdsConfig,l=o.getCurrentPath();return a?l||"/插件"+u.appId:l||(null===(e=s.eventHooks.appEffects.enterParams)||void 0===e?void 0:e.path)||(null===(n=s.lastPageEvent)||void 0===n?void 0:n.path)||(null===(i=s.lastVisitEvent)||void 0===i?void 0:i.path)},this.getPageQuery=function(){var e,n,i,r,o,a,s=t.growingIO,u=s.minipInstance,l=s.dataStore,c=u.getCurrentPage(),d=u.getCurrentPath(),g=l.eventHooks.appEffects.enterParams,p=void 0===g?{}:g;if(!d)return p.path?we(Te(null==p?void 0:p.query,null===(i=null==p?void 0:p.referrerInfo)||void 0===i?void 0:i.extraData)):(null===(r=l.lastPageEvent)||void 0===r?void 0:r.path)?null===(o=l.lastPageEvent)||void 0===o?void 0:o.query:null===(a=l.lastVisitEvent)||void 0===a?void 0:a.query;var v=null!==(e=c.options)&&void 0!==e?e:c.$taroParams;return J(v)?J(t.queryOptions[d])?d===p.path?we(Te(null==p?void 0:p.query,null===(n=null==p?void 0:p.referrerInfo)||void 0===n?void 0:n.extraData)):void 0:we(Te(t.queryOptions[d])):we(Te(v))},this.getPageTitle=function(){var e=t.growingIO,n=e.minipInstance,i=e.inPlugin,r=e.vdsConfig,o=n.getCurrentPath(),a=t.configuredTitle[o]||n.getPageTitle(n.getCurrentPage());return i?a||"/插件"+r.appId+(o?"_"+N(o.split("/")):""):a},this.getReferralPage=function(){var e,n,i=t.growingIO,r=i.minipInstance,o=i.dataStore,a=o.lastPageEvent,s=o.scene,u=o.eventHooks;return(null==a?void 0:a.path)||(null==a?void 0:a.p)||(null===(n=null===(e=u.appEffects.enterParams)||void 0===e?void 0:e.referrerInfo)||void 0===n?void 0:n.appId)||(s?"scn:"+r.scnPrefix+s:null)},this.saveShareId=function(e){(null==e?void 0:e.gioShareId)&&(t.queryShareId=e.gioShareId)},this.updateShareResult=function(e,n){var i=t.buildShareQuery(e,n),r=i[0],o=i[1],a=i[2];return n.path=ue(r+(o?"?"+o:"")),n.attributes=a,n.query=o,n},this.updateAppMessageResult=this.updateShareResult,this.updateTimelineResult=this.updateShareResult,this.updateAddFavoritesResult=function(e,n){var i=t.buildShareQuery(e,n,!1),r=i[0],o=i[1];return n.path=ue(r+(o?"?"+o:"")),n.query=o,n},this.queryOptions={},this.configuredTitle={},this.pageProps={}}return e.prototype.buildShareQuery=function(e,t,i){var r,o;void 0===i&&(i=!0);var a=e.userStore,s=se(null!==(r=t.path)&&void 0!==r?r:""),u=t.path||this.getPagePath(),l={},c=U(t,"path");if(U(t,"query"))l=Se(null!==(o=t.query)&&void 0!==o?o:"")||{};else if(c)l=Se(N(s))||{};else{var d=this.growingIO.minipInstance.getCurrentPage();l=n({},d.options||this.queryOptions[d.route]||{}),V(G(l)).forEach((function(e){(["gioPreShareId","gioShareId","suid"].includes(e)||e.toLowerCase().startsWith("utm_"))&&W(l,e)}))}if(!i)return[u,we(l),{}];var g={gioShareId:ie(),suid:a.uid},p={contentType:t.contentType||l.contentType,contentId:t.contentId||l.contentId,gioPreShareId:this.queryShareId};return $(g,(function(e,t){e||W(g,t)})),[u,we(n(n({},l),g)),n(n({},g),p)]},e}(),Ot=function(e){var t=this;this.growingIO=e,this.main=function(e,n,i){var r,o,a=Date.now(),s=t.growingIO,u=s.emitter,l=s.minipInstance,c=s.plugins,d=s.vdsConfig,g=s.platformConfig,p=s.dataStore,v=p.shareOut,f=p.eventHooks,h=p.toggleShareOut,m=p.buildAppMessageEvent,I=p.buildTimelineEvent,y=p.buildAddFavorites,w=s.inPlugin,S=f.currentPage;if(!t.prevEvent[n]||Date.now()-Number(t.prevEvent[n])>=50){e||(e=l.getCurrentPage()),d.wepy&&(e.route=e.$is),e.route||(e.route=l.getCurrentPath(e));var O=e.route||e.uri||e.__route__||(null===(r=null==e?void 0:e.$page)||void 0===r?void 0:r.fullPath)||"";u.emit("minipLifecycle",{event:"Page "+n,timestamp:a,params:{page:e,args:i[0]}}),d.debug&&console.log("Page:",O,"#",n,a),t.prevEvent[n]=Date.now();var b=g.listeners.page;switch(u.emit("onComposeBefore",{page:e,event:"Page "+n,params:{page:e,args:i[0]}}),S.lastLifecycle=S.currentLifecycle,S.currentLifecycle=n,n){case b.pageLoad:S.queryOptions[O]=Q(e,"options")||Q(e,"__displayReporter.query")||Q(e,"$page.query")||Q(e,"$wx.__displayReporter.query")||Q(e,"$taroParams")||i[0]||{},W(S.queryOptions[O],["$taroTimestamp","gdpCircleRoomCollectUrl"]);break;case b.pageShow:if(w)break;v&&f.currentPage.time||(f.currentPage.time=Date.now(),t.buildPageEvent()),h(!1),S.saveShareId(S.queryOptions[O]);break;case b.pageHide:case b.pageUnload:break;case b.shareApp:h(!0),d.followShare&&m(i);break;case b.shareTime:d.followShare&&I(i);break;case b.addFavorites:y(i);break;case b.tabTap:var T=null===(o=null==c?void 0:c.gioEventAutoTracking)||void 0===o?void 0:o.buildTabClickEvent;d.autotrack&&T&&C(T)&&T(i[0])}n===b.pageUnload&&(S.pageProps[O]=void 0)}},this.buildPageEvent=function(){var e=t.growingIO.dataStore,i=e.eventContextBuilder,r=e.eventInterceptor,o=e.eventHooks.currentPage,a=n(n({eventType:"PAGE",referralPage:o.getReferralPage()},i()),{timestamp:o.time});J(o.pageProps[a.path])||(a.attributes=o.pageProps[a.path]),r(a)},this.prevEvent={}},bt=function(e){var t,o=this;this.growingIO=e,this.isNormalFc=function(e,t){return C(t)&&"constructor"!==e},this.objectTraverse=function(e,t){Object.getOwnPropertyNames(e).forEach((function(n){return t(n,e)})),U(e,"methods")&&Object.getOwnPropertyNames(e.methods).forEach((function(n){e[n]||t(n,e.methods)})),U(e,"lifetimes")&&Object.getOwnPropertyNames(e.lifetimes).forEach((function(n){e[n]||t(n,e.lifetimes)})),U(e,"pageLifetimes")&&Object.getOwnPropertyNames(e.pageLifetimes).forEach((function(n){e[n]||t(n,e.pageLifetimes)}))},this.supLifeFcs=function(e,t){x(o[t+"Handlers"])&&o[t+"Handlers"].forEach((function(t){C(e[t])||["onShareAppMessage","onShareTimeline"].includes(t)||(e[t]=function(){})}))},this.lifeFcEffects=function(e,t,a){var s=o;return["onShareTimeline","onAddToFavorites"].includes(e)?function(){for(var n=[],i=0;arguments.length>i;i++)n[i]=arguments[i];var r=t.apply(this,n);"onShareTimeline"===e&&s.growingIO.vdsConfig.followShare&&(r=s.currentPage.updateTimelineResult(s.growingIO,null!=r?r:{})),"onAddToFavorites"===e&&(r=s.currentPage.updateAddFavoritesResult(s.growingIO,null!=r?r:{}));var o=[].slice.call(n);return r&&o.push(r),s["def"+a+"Cbs"][e].apply(this,o),r}:function(){for(var o,u=[],l=0;arguments.length>l;l++)u[l]=arguments[l];return i(this,void 0,void 0,(function(){var i,l,c,d,g;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),"onShareAppMessage"!==e?[3,5]:(i=null!==(o=t.apply(this,u))&&void 0!==o?o:{},"promise"!==X(i)?[3,2]:[4,i.then((function(e){return e}))]);case 1:i=r.sent(),r.label=2;case 2:return"promise"!==X(i.promise)?[3,4]:(l=function(){var e=i;return new Promise((function(t){var r=setTimeout((function(){t(n({},e)),clearTimeout(r),r=void 0}),3e3);i.promise.then((function(i){t(n({},e=i)),clearTimeout(r),r=void 0}))}))},c=[n({},i)],[4,l()]);case 3:i=n.apply(void 0,c.concat([r.sent()])),W(i,"promise"),r.label=4;case 4:s.growingIO.vdsConfig.followShare&&(i=s.currentPage.updateAppMessageResult(s.growingIO,null!=i?i:{})),r.label=5;case 5:return d=[].slice.call(u),i&&d.push(i),s["def"+a+"Cbs"][e].apply(this,d),[3,7];case 6:return g=r.sent(),Y(g,"error"),[3,7];case 7:return"onShareAppMessage"!==e&&(i=t.apply(this,u)),s.growingIO.emitter.emit("minipLifecycle",{event:a+" "+e+"End",timestamp:Date.now(),params:{instance:this,arguments:Array.from(u)}}),[2,i]}}))}))}},this.customFcEffects=function(e,t){var n=o;return function(){for(var i,r,o=[],a=0;arguments.length>a;a++)o[a]=arguments[a];if(n.growingIO.vdsConfig.autotrack&&n.growingIO.plugins.gioEventAutoTracking)try{var s=o[0]||{};U(s,"type")&&((null==s?void 0:s.currentTarget)||(null==s?void 0:s.target))||(s=o[o.length-1]),((null==s?void 0:s.currentTarget)||(null==s?void 0:s.target))&&n.actionEventTypes.includes(s.type)&&(C(n.actionEffects)||(n.actionEffects=(null===(r=null===(i=n.growingIO.plugins)||void 0===i?void 0:i.gioEventAutoTracking)||void 0===r?void 0:r.main)||function(){}),null==n||n.actionEffects(s,e))}catch(e){Y(e,"error")}return t.apply(this,o)}},this.appApplyProxy=function(e,t){return o.appHandlers.includes(e)?o.lifeFcEffects(e,t,"App"):o.customFcEffects(e,t)},this.pageApplyProxy=function(e,t){return o.pageHandlers.includes(e)?o.lifeFcEffects(e,t,"Page"):o.customFcEffects(e,t)},this.appOverriding=function(e){return o.supLifeFcs(e,"app"),o.objectTraverse(e,(function(e,t){o.isNormalFc(e,t[e])&&(t[e]=o.appApplyProxy(e,t[e]))})),e},this.pageOverriding=function(e){return o.supLifeFcs(e,"page"),o.objectTraverse(e,(function(e,t){o.isNormalFc(e,t[e])&&(t[e]=o.pageApplyProxy(e,t[e]))})),e},this.componentOverriding=function(e){return e.methods||(e.methods={}),o.supLifeFcs(e.methods,"page"),o.objectTraverse(e.methods,(function(e,t){o.isNormalFc(e,t[e])&&(t[e]=o.pageApplyProxy(e,t[e]))})),e},this.growingApp=function(e){return o.originalApp(o.appOverriding(e))},this.growingPage=function(e){return o.originalPage(o.pageOverriding(e))},this.growingComponent=function(e){return o.originalComponent(o.componentOverriding(e))},this.growingBehavior=function(e){return o.originalBehavior(o.componentOverriding(e))},this.nativeGrowing=function(e){void 0===e&&(e=["App","Page","Component","Behavior"]);var t=o,n=o.growingIO.platformConfig.hooks;if(e.includes("App"))try{n.App&&!o.appHooked&&(o.originalApp=App||global.App||function(){},App=function(){for(var e=[],n=0;arguments.length>n;n++)e[n]=arguments[n];return t.growingApp(e[0])},o.appHooked=!0)}catch(e){}if(e.includes("Page"))try{n.Page&&!o.pageHooked&&(o.originalPage=Page||global.Page||function(){},Page=function(){for(var e=[],n=0;arguments.length>n;n++)e[n]=arguments[n];return t.growingPage(e[0])},o.pageHooked=!0)}catch(e){}if(e.includes("Component"))try{n.Component&&!o.componentHooked&&(o.originalComponent=Component||global.Component||function(){},Component=function(){for(var e=[],n=0;arguments.length>n;n++)e[n]=arguments[n];return t.growingComponent(e[0])},o.componentHooked=!0)}catch(e){}if(e.includes("Behavior"))try{n.Behavior&&!o.behaviorHooked&&(o.originalBehavior=Behavior||global.Behavior||function(){},Behavior=function(){for(var e=[],n=0;arguments.length>n;n++)e[n]=arguments[n];return t.growingBehavior(e[0])},o.behaviorHooked=!0)}catch(e){}},this.initEventHooks=function(){var e=o,t=o.growingIO,n=t.platformConfig,i=t.gioPlatform;o.appHandlers.forEach((function(t){o.defAppCbs[t]=function(){for(var n=[],i=0;arguments.length>i;i++)n[i]=arguments[i];e.appEffects.main(t,n)}})),o.pageHandlers.forEach((function(t){o.defPageCbs[t]=function(){for(var n=[],i=0;arguments.length>i;i++)n[i]=arguments[i];e.pageEffects.main(this,t,n)}})),n.canHook?o.nativeGrowing():"quickapp"===i&&(window.GioApp=function(){for(var t=[],n=0;arguments.length>n;n++)t[n]=arguments[n];return e.appOverriding(t[0])},window.GioPage=function(){for(var t=[],n=0;arguments.length>n;n++)t[n]=arguments[n];return e.pageOverriding(t[0])},window.GioComponent=function(){for(var t=[],n=0;arguments.length>n;n++)t[n]=arguments[n];return e.pageOverriding(t[0])}),o.growingIO.App=ee((function(){return App})),o.growingIO.Page=ee((function(){return Page})),o.growingIO.Component=ee((function(){return Component})),o.growingIO.Behavior=ee((function(){return Behavior})),"quickapp"===i&&(o.growingIO.GioApp=window.GioApp,o.growingIO.GioPage=window.GioPage,o.growingIO.GioComponent=window.GioComponent)};var a=null===(t=this.growingIO)||void 0===t?void 0:t.platformConfig;this.defAppCbs={},this.defPageCbs={},this.appHandlers=a.appHandlers,this.pageHandlers=a.pageHandlers,this.actionEventTypes=a.actionEventTypes,this.appEffects=new wt(this.growingIO),this.pageEffects=new Ot(this.growingIO),this.currentPage=new St(this.growingIO)},Tt=function(){function e(e){var t=this;this.growingIO=e,this.ALLOW_SETTING=Object.assign({},a,"saas"===this.growingIO.gioEnvironment?u:s),this.allowOptKeys=G(this.ALLOW_SETTING),this.initStorageInfo=function(){var e=t.growingIO.minipInstance,n=fe(),i=n.gio_esid?n.gio_esid:e.getStorageSync(t.esidStorageName);i=k(i)&&!T(i)?i:{},t._esid={},G(i).forEach((function(e){t._esid[e]=Number.isNaN(Number(i[e]))||i[e]>=1e9||1>i[e]?1:i[e]})),K(i,t._esid)||e.setStorageSync(t.esidStorageName,t._esid);var r=n.gio_gsid?n.gio_gsid:Number(e.getStorageSync(t.gsidStorageName));t._gsid=Number.isNaN(r)||r>=1e9||1>r?1:r,t._stid=t._gsid,r!==t._gsid&&e.setStorageSync(t.gsidStorageName,t._gsid)},this.saveStorageInfo=function(){var e=t.growingIO.minipInstance;t._stid=t._gsid,ye(e,[{key:t.esidStorageName,value:t._esid},{key:t.gsidStorageName,value:t._gsid}])},this.initOptions=function(e){var i,r,o,a,s,u,l,c,d,g,p,v=e.projectId,f=e.dataSourceId,h=e.appId,m={};t.allowOptKeys.forEach((function(n){var i=t.ALLOW_SETTING[n].type;(x(i)?i.includes(X(e[n])):X(e[n])===t.ALLOW_SETTING[n].type)?"ignoreFields"===n?m.ignoreFields=e.ignoreFields.filter((function(e){return O.includes(e)})):"extraParams"===n?m.extraParams=e.extraParams.filter((function(e){return b.includes(e)})):m[n]=e[n]:m[n]=t.ALLOW_SETTING[n].default})),m.uploadInterval=Math.round(m.uploadInterval),(Number.isNaN(m.uploadInterval)||0>m.uploadInterval||m.uploadInterval>2e3)&&(m.uploadInterval=1e3),!isNaN(Number(m.requestTimeout))&&m.requestTimeout>0||(m.requestTimeout=5e3),t.growingIO.vdsConfig=n(n({},m),{projectId:v,dataSourceId:f,appId:h,performance:{monitor:null===(r=null===(i=m.performance)||void 0===i?void 0:i.monitor)||void 0===r||r,exception:null===(a=null===(o=m.performance)||void 0===o?void 0:o.exception)||void 0===a||a,network:null!==(u=null===(s=m.performance)||void 0===s?void 0:s.network)&&void 0!==u&&u}}),t.keepAlive=m.keepAlive,m.dataCollect||Y("已关闭数据采集","info"),m.autotrack||Y("已关闭无埋点","info"),t.growingIO.inPlugin&&(t.growingIO.vdsConfig.autotrack=!1);var I=m.cml,y=m.uniVue,w=m.wepy,S=m.taro,T=m.remax;"full"!==t.growingIO.gioFramework||I||y||w||S||T||(t.growingIO.platformConfig.canHook=!0),t.growingIO.inPlugin||t.eventHooks.initEventHooks();var _=t.growingIO.plugins;I&&(null===(l=null==_?void 0:_.gioChameleonAdapter)||void 0===l||l.main()),y&&(null===(c=null==_?void 0:_.gioUniAppAdapter)||void 0===c||c.main()),w&&(null===(d=null==_?void 0:_.gioWepyAdapter)||void 0===d||d.main()),S&&(null===(g=null==_?void 0:_.gioTaroAdapter)||void 0===g||g.main()),T&&(null===(p=null==_?void 0:_.gioRemaxAdapter)||void 0===p||p.main())},this.setOption=function(e,n){var i,r=t.growingIO,o=r.vdsConfig,a=r.callError,s=r.uploader,u=r.emitter,l=_(e)&&t.allowOptKeys.includes(e),c=l&&typeof n===(null===(i=t.ALLOW_SETTING[e])||void 0===i?void 0:i.type);if(l&&c){if("dataCollect"===e&&!1===o.dataCollect&&!0===n)var d=setTimeout((function(){t.sendVisit(),t.eventHooks.currentPage.time=Date.now(),t.sendPage(),clearTimeout(d),d=null}));return o[e]=n,["host","scheme"].includes(e)&&(null==s||s.generateURL()),u.emit("OPTION_CHANGE",{optionName:e,optionValue:n}),!0}return a("setOption > "+e),!1},this.getOption=function(e){var i=t.growingIO,r=i.vdsConfig,o=i.callError;return e&&U(r,F(e))?r[F(e)]:T(e)?n({},r):void o("getOption > "+e)},this.toggleShareOut=function(e){E(e)?t.shareOut=e:t.shareOut=!t.shareOut},this.sendVisit=function(){t.eventHooks.appEffects.buildVisitEvent(t.lastVisitEvent)},this.sendPage=function(){t.eventHooks.pageEffects.buildPageEvent()},this.eventInterceptor=function(e){var i=t.growingIO.minipInstance,r=i.systemInfo,a=i.network;J(r)||J(a)?t.interceptEvents.push(e):J(t.interceptEvents)?t.eventConverter(e):(o(o([],t.interceptEvents),[e]).forEach((function(e){var i=n(n({},e),t.eventContextBuilder({path:e.path,query:e.query,timestamp:e.timestamp}));t.eventConverter(i)})),t.interceptEvents=[])},this.eventReleaseInspector=function(){var e=t.growingIO.minipInstance,i=e.systemInfo,r=e.network;i&&r&&!J(t.interceptEvents)&&(o([],t.interceptEvents).forEach((function(e){var i=n(n({},e),t.eventContextBuilder({path:e.path,query:e.query,timestamp:e.timestamp}));t.eventConverter(i)})),t.interceptEvents=[])},this.buildAppMessageEvent=function(e){},this.buildTimelineEvent=function(e){},this.buildAddFavorites=function(e){},this.esidStorageName="_growing_esid_",this.gsidStorageName="_growing_gsid_",this.initStorageInfo(),this.eventContextBuilder=new yt(this.growingIO).main,this.eventHooks=new bt(this.growingIO),this.shareOut=!1,this.lastVisitEvent={},this.lastPageEvent={},this.locationData={},this.generalProps={},this.interceptEvents=[],this.growingIO.emitter.on("onComposeAfter",(function(e){var n=e.composedEvent;"VISIT"!==n.eventType&&"vst"!==n.t||(t.lastVisitEvent=n),"PAGE"!==n.eventType&&"page"!==n.t||(t.lastPageEvent=n)}))}return Object.defineProperty(e.prototype,"esid",{get:function(){var e=fe(),t=ve(e);return!J(t)&&e.gio_esid?e.gio_esid:this._esid},set:function(e){var t={};G(e).forEach((function(n){t[n]=Number.isNaN(e[n])||e[n]>=1e9||1>e[n]?1:e[n]})),K(t,this._esid)||(this._esid=t,fe().gio_esid=this._esid)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gsid",{get:function(){var e=fe(),t=ve(e);return!J(t)&&e.gio_gsid?e.gio_gsid:this._gsid},set:function(e){var t=Number(e);this._gsid=Number.isNaN(t)||e>=1e9||1>e?1:e,fe().gio_gsid=this._gsid,10>this._gsid-this._stid||this.saveStorageInfo()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scene",{get:function(){return this._scene},set:function(e){var t=this._scene;this._scene=e,t!==this._scene&&this.growingIO.emitter.emit("SCENE_UPDATE",{newScene:e,oldScene:t})},enumerable:!1,configurable:!0}),e}(),_t=function(e){function i(t){var i=e.call(this,t)||this;return i.growingIO=t,i.eventConverter=function(e){var t,r=i.growingIO,o=r.vdsConfig,a=r.dataStore,s=r.uploader;if(o.dataCollect){e.globalSequenceId=a.gsid,e.eventSequenceId=a.esid[e.eventType]||1;var u={};$(e,(function(e,t){var n;if("element"===t){var i=null!==(n=A(e))&&void 0!==n?n:{};$(i,(function(e,t){J(e)&&0!==e||(u[t]=e)}))}else J(e)&&0!==e||(u[t]=e)})),i.growingIO.dataStore.gsid+=1,i.growingIO.dataStore.esid=n(n({},i.growingIO.dataStore.esid),((t={})[u.eventType]=(i.growingIO.dataStore.esid[u.eventType]||1)+1,t)),i.growingIO.emitter.emit("onComposeAfter",{composedEvent:u}),s.commitRequest(u)}},i.buildAppMessageEvent=function(e){var t,r,o=e[0];2>e.length?1===e.length&&(r=o):r=e[1];var a=i.growingIO.dataStore,s=a.eventContextBuilder,u=a.eventInterceptor,l=a.eventHooks.currentPage,c=((null==r?void 0:r.path)||"").split("?");u(n({eventType:"CUSTOM",eventName:"$mp_on_share",pageShowTimestamp:l.time,attributes:n({$from:o.from,$target:null===(t=null==o?void 0:o.target)||void 0===t?void 0:t.id,$share_title:null==r?void 0:r.title,$share_path:A(c),$share_query:c[1]},null==r?void 0:r.attributes)},s()))},i.buildTimelineEvent=function(e){var t,r,o=e[0];2>e.length?1===e.length&&(r=o):r=e[1];var a=i.growingIO.dataStore,s=a.eventContextBuilder,u=a.eventInterceptor,l=a.eventHooks.currentPage,c=((null==r?void 0:r.path)||"").split("?");u(n({eventType:"CUSTOM",eventName:"$mp_share_timeline",pageShowTimestamp:l.time,attributes:n({$target:null===(t=null==o?void 0:o.target)||void 0===t?void 0:t.id,$share_title:null==r?void 0:r.title,$share_path:A(c),$share_query:c[1]},null==r?void 0:r.attributes)},s()))},i.buildAddFavorites=function(e){var t,r=e[0];2>e.length?1===e.length&&(t=r):t=e[1];var o=i.growingIO.dataStore,a=o.eventContextBuilder,s=o.eventInterceptor,u=o.eventHooks.currentPage,l=((null==t?void 0:t.path)||"").split("?");s(n({eventType:"CUSTOM",eventName:"$mp_add_favorites",pageShowTimestamp:u.time,attributes:{$share_title:null==t?void 0:t.title,$share_path:A(l),$share_query:l[1]}},a()))},i.trackTimers={},i}return t(i,e),i}(Tt),Pt=function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.generateURL=function(){var e=n.growingIO.vdsConfig,t=e.scheme,i=e.host,r=void 0===i?"":i,o=e.projectId;t&&R(t,"http")?M(F(t),"://")||(t+="://"):t="https://",r=r.replace("http://","").replace("https://",""),n.requestURL=""+t+r+"/v3/projects/"+o+"/collect"},n.generateURL(),n}return t(n,e),n}((function(e){var t=this;this.growingIO=e,this.commitRequest=function(e){var i=n({},e);t.growingIO.vdsConfig.forceLogin?t.hoardingQueue.push(i):(t.requestQueue.push(i),t.initiateRequest())},this.initiateRequest=function(e){var n,i,r=t.growingIO,a=r.plugins,s=r.vdsConfig;o(o([],t.hoardingQueue),t.requestQueue).length>0&&t.requestingNum<t.requestLimit&&((null===(n=null==s?void 0:s.tbConfig)||void 0===n?void 0:n.cloudFuncSend)?null===(i=null==a?void 0:a.gioTaobaoSendAdapter)||void 0===i||i.singleInvoke():e?t.batchInvoke():t.batchInvokeThrottle())},this.batchInvoke=function(){var e,n,i=t.growingIO,r=i.vdsConfig,a=i.plugins,s=i.emitter,u=o(o([],t.hoardingQueue),t.requestQueue);u.length>50?(u=u.slice(0,50),t.hoardingQueue.length>50?t.hoardingQueue=t.hoardingQueue.slice(50):(t.requestQueue=t.requestQueue.slice(50-t.hoardingQueue.length),t.hoardingQueue=[])):(t.hoardingQueue=[],t.requestQueue=[]);var l=u.filter((function(e){return(t.retryIds[e.globalSequenceId||e.esid]||0)<=t.retryLimit}));J(l)||(r.debug&&console.log("[GrowingIO Debug]:",JSON.stringify(l,null,2)),s.emit("onSendBefore",{requestData:l}),(null===(e=null==r?void 0:r.tbConfig)||void 0===e?void 0:e.cloudAppId)?null===(n=null==a?void 0:a.gioTaobaoSendAdapter)||void 0===n||n.tbCloudAppInvoke(l):t.normalBatchInvoke(l))},this.batchInvokeThrottle=z(this.batchInvoke,this.growingIO.vdsConfig.uploadInterval,!1,!1),this.normalBatchInvoke=function(e){var n,i=t.growingIO,r=i.minipInstance,a=i.vdsConfig,s=i.emitter,u=i.plugins,l=i.gioEnvironment;t.requestingNum+=1;var c={"content-type":"jdp"===r.platform?"application/json":"application/json;charset=UTF-8"},d=o([],e),g=a.compress&&(null===(n=null==u?void 0:u.gioCompress)||void 0===n?void 0:n.compressToUTF16);"cdp"===l&&g&&(d=u.gioCompress.compressToUTF16(JSON.stringify(e)),c["X-Compress-Codec"]="1"),r.request({url:t.requestURL+"?stm="+Date.now()+("cdp"===l?"&compress="+(g?"1":"0"):""),header:c,method:"POST",data:d,timeout:a.requestTimeout,fail:function(n){[200,204].includes(n.code)||(x(e)?e.forEach((function(e){t.requestFailFn(e)})):t.requestFailFn(e),Y("请求失败!"+JSON.stringify(n),"error"))},complete:function(e){t.requestingNum-=1,s.emit("onSendAfter",{result:e}),t.initiateRequest()}})},this.requestFailFn=function(e){if(t.retryIds[e.globalSequenceId||e.esid]||(t.retryIds[e.globalSequenceId||e.esid]=0),t.retryIds[e.globalSequenceId||e.esid]+=1,!t.requestQueue.some((function(t){return t.globalSequenceId===e.globalSequenceId&&t.esid===e.esid})))var n=setTimeout((function(){J(t.requestQueue)?(t.requestQueue.push(e),t.initiateRequest()):t.requestQueue.push(e),clearTimeout(n),n=null}),800)},this.hoardingQueue=[],this.requestQueue=[],this.requestLimit=3,this.retryLimit=2,this.retryIds={},this.requestingNum=0,this.requestURL=""})),Et=new(function(e){function i(){var t,i,r=e.call(this)||this;return r.registerPlugins=function(e){r.plugins.pluginItems=o(o([],r.plugins.pluginItems),e),r.plugins.installAll(e)},r.initCallback=function(){r.uploader=new Pt(r),r.vdsConfig.enableIdMapping||(r.userStore.userKey="")},r.setTrackerScheme=function(e){["http","https"].includes(e)?(r.dataStore.setOption("scheme",e),r.notRecommended()):r.callError("scheme",!1)},r.setTrackerHost=function(e){Ee.test(e)||ke.test(e)?(r.dataStore.setOption("host",e),r.notRecommended()):r.callError("host",!1)},r.identify=function(e){if(r.vdsConfig.forceLogin){if(!Pe(e))return void r.callError("identify");var t=F(e).slice(0,1e3);r.userStore.uid=t,r.uploader.hoardingQueue.forEach((function(e,n){return r.uploader.hoardingQueue[n].deviceId=t})),r.dataStore.setOption("forceLogin",!1),r.uploader.initiateRequest(!0)}else r.callError("identify",!1,"forceLogin未开启")},r.setUserAttributes=function(e){var t,n;!J(e)&&k(e)?null===(n=null===(t=r.plugins)||void 0===t?void 0:t.gioCustomTracking)||void 0===n||n.buildUserAttributesEvent(e):r.callError("setUserAttributes")},r.setUserId=function(e,t){if(Pe(e)){var n=r.userStore.gioId;e=F(e).slice(0,1e3),t=F(t).slice(0,1e3),r.userStore.userId=e,r.vdsConfig.enableIdMapping&&(r.userStore.userKey=T(t)?"":t),r.reissueLogic(n,e)}else r.callError("setUserId")},r.clearUserId=function(){r.userStore.userId=void 0,r.userStore.userKey=void 0},r.track=function(e,t,i){var o,a;((null===(a=null===(o=r.plugins)||void 0===o?void 0:o.gioCustomTracking)||void 0===a?void 0:a.buildCustomEvent)||function(){})(e,n(n({},r.dataStore.generalProps),k(t)&&!J(t)?t:{}),i)},r.reissueLogic=function(e,t){e&&e!==t&&(r.userStore.sessionId="",r.dataStore.sendVisit()),e||e===t||r.dataStore.sendVisit()},r.trackTimerStart=function(e){return!!r.vdsConfig.dataCollect&&ne(e,(function(){var t=ie();return r.dataStore.trackTimers[t]={eventName:e,leng:0,start:+Date.now()},t}))},r.trackTimerPause=function(e){if(e&&r.dataStore.trackTimers[e]){var t=r.dataStore.trackTimers[e];return t.start&&(t.leng=t.leng+(+Date.now()-t.start)),t.start=0,!0}return!1},r.trackTimerResume=function(e){if(e&&r.dataStore.trackTimers[e]){var t=r.dataStore.trackTimers[e];return 0===t.start&&(t.start=+Date.now()),!0}return!1},r.trackTimerEnd=function(e,t){if(r.vdsConfig.dataCollect){if(e&&r.dataStore.trackTimers[e]){var i=r.dataStore.trackTimers[e];if(0!==i.start){var o=+Date.now()-i.start;i.leng=o>0?i.leng+o:0}return r.track(i.eventName,n(n({},t),{event_duration:i.leng>864e5?0:i.leng/1e3})),r.removeTimer(e),!0}return Y("未查找到对应的计时器，请检查!","error"),!1}return!1},r.removeTimer=function(e){return!(!e||!r.dataStore.trackTimers[e]||(delete r.dataStore.trackTimers[e],0))},r.clearTrackTimer=function(){r.dataStore.trackTimers={}},r.dataStore=new _t(r),C(null===(t=r.minipInstance.minip)||void 0===t?void 0:t.onAppHide)&&r.minipInstance.minip.onAppHide((function(){$(r.dataStore.trackTimers,(function(e){e.start&&(e.leng=e.leng+(+Date.now()-e.start))}))})),C(null===(i=r.minipInstance.minip)||void 0===i?void 0:i.onAppShow)&&r.minipInstance.minip.onAppShow((function(){$(r.dataStore.trackTimers,(function(e){e.start&&(e.start=+Date.now())}))})),r.emitter.on("OPTION_CHANGE",(function(e){var t=e.optionName,n=e.optionValue;"dataCollect"===t&&!1===n&&r.clearTrackTimer()})),r}return t(i,e),i}((function(){var e,t=this;this.init=function(e){return Y("Gio小程序SDK 初始化中...","info"),t.dataStore.initOptions(e),t.gioSDKInitialized=!0,t.vdsConfig.subpackage||(fe().__gio__=function(){return t}),null==t||t.initCallback(),t.emitter.emit("SDK_INITIALIZED",t),Y("Gio小程序SDK 初始化完成！","success"),t.vdsConfig.forceLogin&&Y("forceLogin已开启，请调用 identify 方法设置 openId 以继续上报!","info"),t.inPlugin&&t.dataStore.sendVisit(),!0},this.setDataCollect=function(e){t.setOption("dataCollect",!!e),t.notRecommended()},this.setAutotrack=function(e){t.setOption("autotrack",!!e),t.notRecommended()},this.enableDebug=function(e){t.setOption("debug",!!e),t.notRecommended()},this.setOption=function(e,n){if(y.includes(e)){var i=t.dataStore.setOption(e,n);return i&&w[e]&&Y("已"+(n?"开启":"关闭")+w[e],"info"),i}return Y("不存在可修改的配置项："+e+"，请检查后重试!","warn"),!1},this.getDeviceId=function(){return t.userStore.uid},this.getOption=function(e){return t.dataStore.getOption(e)},this.getGioInfo=function(){var e=t.userStore,n=e.uid,i=e.userId,r=e.userKey,o=e.sessionId,a=e.gioId,s=t.vdsConfig,u=s.projectId,l=s.appId,c=s.dataSourceId,d=s.dataCollect,g=s.enableIdMapping,p=s.extraParams,v=s.ignoreFields,f={gioappid:l,giocs1:i||"",gioplatform:t.platformConfig.platform,gioprojectid:u,gios:o,giou:n};return"cdp"===t.gioEnvironment&&(f.giodatacollect=d,f.giodatasourceid=c,f.gioid=a||"",g&&(f.giouserkey=r),J(p)||p.forEach((function(e){v.includes(e)||(f["gio"+e]=t.dataStore.lastVisitEvent[e])}))),ft.stringify(f)},this.setLocation=function(e,n){var i={latitude:e,longitude:n},r=t.dataStore.locationData,o=function(e){return e>=-180&&180>=e};o(e)&&o(n)&&(r.latitude!==e||r.longitude!==n)&&(t.dataStore.locationData=i,t.dataStore.sendVisit())},this.setGeneralProps=function(e){k(e)&&!J(e)?(t.dataStore.generalProps=n(n({},t.dataStore.generalProps),e),G(t.dataStore.generalProps).forEach((function(e){[void 0,null].includes(t.dataStore.generalProps[e])&&(t.dataStore.generalProps[e]="")}))):t.callError("setGeneralProps")},this.clearGeneralProps=function(e){x(e)&&!J(e)?e.forEach((function(e){W(t.dataStore.generalProps,e)})):t.dataStore.generalProps={}},this.setPageAttributes=function(e){var n=t.dataStore.eventHooks.currentPage,i=t.minipInstance.getCurrentPath();["onLoad","attached"].includes(n.currentLifecycle)&&(n.pageProps[i]=me(e))},this.updateImpression=function(){Y("当前未集成半自动浏览插件，请集成插件后再调用 updateImpression!","warn")},this.notRecommended=function(){return Y("不推荐的方法使用，建议使用 gio('setOption', [optionName], [value])!","info")},this.callError=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n="参数不合法"),Y((t?"调用":"设置")+" "+e+" 失败，"+n+"!","warn")},this.utils=n(n(n({},Z),_e),{qs:ft}),this.emitter={all:e=e||new Map,on:function(t,n){var i=e.get(t);i?i.push(n):e.set(t,[n])},off:function(t,n){var i=e.get(t);i&&(n?i.splice(i.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var i=e.get(t);i&&i.slice().map((function(e){e(n)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,n)}))}},this.gioPlatform=pe(),this.gioFramework="full",this.gioEnvironment="cdp",this.sdkVersion="3.8.21";try{"quickapp"===this.gioPlatform||C(getApp)&&C(App)?this.inPlugin=!1:this.inPlugin=!0}catch(e){this.inPlugin=!0}this.inPlugin&&Y("未检测到小程序实例，自动切换为插件模式!","info"),this.platformConfig=at,this.minipInstance=new vt(this),this.userStore=new ze(this),this.plugins=new We(this),this.plugins.innerPluginInit()}))),kt=function(){var e,t=arguments[0];if(_(t)&&I.includes(t)&&Et[t]){var i=q(Array.from(arguments));if("init"===t){var r=!(e=Et).vdsConfig&&!e.gioSDKInitialized||(Y("SDK重复初始化，请检查是否重复加载SDK或接入其他平台SDK导致冲突!","warn"),!1),o=function(e){return!!V(e)||(Y('SDK初始化失败，请使用 gdp("init", "您的GrowingIO项目 accountId", "您项目的 dataSourceId", "你的应用 AppId", options); 进行初始化!',"error"),!1)}(i),a=function(e){var t=e[0],n=N(e);return Pe(t)?(k(n)&&n||(n={}),{projectId:t,userOptions:n}):(Y("SDK初始化失败，accountId 参数不合法!","error"),!1)}(i),s=function(e){var t=e[1],n=e[2],i=N(e);return t&&_(t)?Pe(n)?{dataSourceId:t,appId:n,cdpOptions:i}:(Y("SDK初始化失败，appId 参数不合法!","error"),!1):(Y("SDK初始化失败，dataSourceId 参数不合法!","error"),!1)}(i);if(r&&o&&a&&s){var u=a.projectId,l=s.dataSourceId,c=s.appId,d=s.cdpOptions;return Et.init(n(n({},d),{projectId:u,dataSourceId:l,appId:c}))}}else if("registerPlugins"===t)Et.registerPlugins(i[0]);else{if(Et.gioSDKInitialized&&Et.vdsConfig)return Et[t].apply(Et,i);Y("SDK未初始化!","error")}}else S.includes(t)?Y("方法 "+F(t)+" 已被弃用!","warn"):Y("不存在名为 "+F(t)+" 的方法调用!","error")};he().gdp=kt,he().gioEnvironment="cdp",he().gioSDKVersion=Et.sdkVersion;export default kt;
