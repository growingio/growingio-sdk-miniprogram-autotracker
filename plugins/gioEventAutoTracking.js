var e=function(){return e=Object.assign||function(e){for(var t,n=1,a=arguments.length;a>n;n++)for(var i in t=arguments[n])({}).hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},e.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var t,n={name:"gioEventAutoTracking",method:function(n){var a=this;this.growingIO=n,this.main=function(e,n){var i,r,o=a.growingIO,l=o.vdsConfig,u=o.platformConfig,d=o.plugins,g=o.emitter;if(!(!l.autotrack||!n||t.get(e,"currentTarget.dataset.growingIgnore")||t.get(e,"target.dataset.growingIgnore")||!t.get(e,"target.dataset.growingTrack")&&"autoplay"===t.get(e,"detail.source")||e.type===(null===(i=a.prevEvent)||void 0===i?void 0:i.type)&&10>Math.abs(Number(e.timeStamp)-Number(null===(r=a.prevEvent)||void 0===r?void 0:r.timeStamp))||l.taro&&["eh"].includes(n)||l.cml&&["_cmlEventProxy","onclick","blurEvent","handleDetail"].includes(n))){a.prevEvent=e,l.uniVue&&(n=null==d?void 0:d.gioUniAppAdapter.getHandlerName(n,e)),l.remax&&n.indexOf("$$REMAX_METHOD")>-1&&(n=null==d?void 0:d.gioRemaxAdapter.getHandlerName(n)),l.debug&&console.log("Actionï¼š",e.type,Date.now()),g.emit("onComposeBefore",{event:n,params:null!=e?e:{}});var v=u.listeners.actions;v.click.includes(e.type)?a.buildClickEvent(e,n):v.change.includes(e.type)?a.buildChangeEvent(e,n):v.submit.includes(e.type)&&a.buildSubmitEvent(e,n)}},this.getNodeXpath=function(e,t){var n,i,r,o=a.growingIO,l=o.gioPlatform,u=o.vdsConfig,d=(e.currentTarget||e.target).id;if((!d||"swan"===l&&/^_[0-9a-f]+/.test(d)||(i=(n=u.taro).Current,r=n.createComponent,n&&i&&!r&&/^_n_[0-9]+$/.test(d)))&&(d=""),!u.octopus||(t=e.handler,/^bound .*/.test(t)&&(t=t.replace("bound ","")),/^t[0-9]+$/.test(d)&&(d=""),d&&!t&&(t="anonymousFunc"),d||t))return"".concat(d,"#").concat(t)},this.buildClickEvent=function(n,i){var r,o,l,u=a.getNodeXpath(n,i);if(u){var d=a.growingIO,g=d.dataStore,v=g.eventContextBuilder,s=g.eventInterceptor,p=g.eventHooks,c=d.gioEnvironment,m=n.currentTarget||n.target,h=void 0;t.has(null==m?void 0:m.dataset,"index")&&""!==(null===(r=null==m?void 0:m.dataset)||void 0===r?void 0:r.index)&&(h=Number.parseInt(m.dataset.index,10),Number.isNaN(h)&&(h=-1)),s(e({eventType:"saas"===c&&n.type.includes("long")?"lngprss":"VIEW_CLICK",pageShowTimestamp:p.currentPage.time,element:[{xpath:u,index:h,textValue:null===(o=null==m?void 0:m.dataset)||void 0===o?void 0:o.title,hyperlink:null===(l=null==m?void 0:m.dataset)||void 0===l?void 0:l.src}]},v()))}},this.buildTabClickEvent=function(n){var i=a.growingIO.dataStore,r=i.eventContextBuilder,o=i.eventInterceptor,l=i.eventHooks;o(e({eventType:"VIEW_CLICK",pageShowTimestamp:l.currentPage.time,element:[{xpath:"#onTabItemTap",textValue:n.text,index:n.index,hyperlink:t.toString(n.pagePath)}]},r()))},this.buildChangeEvent=function(n,i){var r,o,l=a.getNodeXpath(n,i);if(l){var u=a.growingIO.dataStore,d=u.eventContextBuilder,g=u.eventInterceptor,v=u.eventHooks,s=n.currentTarget||n.target,p=e({eventType:"VIEW_CHANGE",pageShowTimestamp:v.currentPage.time,element:{xpath:l}},d()),c=t.get(n,"detail.value")||t.get(n,"target.attr.value");((null===(r=null==s?void 0:s.dataset)||void 0===r?void 0:r.growingTrack)||(null===(o=null==s?void 0:s.dataset)||void 0===o?void 0:o.growingtrack))&&(t.isNil(c)||(p.element.textValue=t.toString(c))),p.element=[p.element],g(p)}},this.buildSubmitEvent=function(t,n){var i=a.getNodeXpath(t,n);if(i){var r=a.growingIO.dataStore,o=r.eventContextBuilder,l=r.eventInterceptor,u=r.eventHooks;l(e({eventType:"FORM_SUBMIT",pageShowTimestamp:u.currentPage.time,element:[{xpath:i}]},o()))}},t=this.growingIO.utils,this.prevEvent={}}};export{n as default};
