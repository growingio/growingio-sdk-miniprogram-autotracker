var e,t=function(){return t=Object.assign||function(e){for(var t,n=1,a=arguments.length;a>n;n++)for(var i in t=arguments[n])({}).hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)},n={name:"gioEventAutoTracking",method:function(n){var a=this;this.growingIO=n,this.main=function(t,n){var i,r,o=a.growingIO,l=o.vdsConfig,u=o.platformConfig,d=o.plugins,g=o.emitter;if(!(!l.autotrack||!n||e.get(t,"currentTarget.dataset.growingIgnore")||e.get(t,"target.dataset.growingIgnore")||!e.get(t,"target.dataset.growingTrack")&&"autoplay"===e.get(t,"detail.source")||t.type===(null===(i=a.prevEvent)||void 0===i?void 0:i.type)&&10>Math.abs(Number(t.timeStamp)-Number(null===(r=a.prevEvent)||void 0===r?void 0:r.timeStamp))||(a.prevEvent=t,l.uniVue&&(n=null==d?void 0:d.gioUniAppAdapter.getHandlerName(n,t)),l.taro&&["eh"].includes(n)||l.cml&&["_cmlEventProxy","onclick","blurEvent","handleDetail"].includes(n)))){l.remax&&n.indexOf("$$REMAX_METHOD")>-1&&(n=null==d?void 0:d.gioRemaxAdapter.getHandlerName(n)),l.debug&&console.log("Actionï¼š",t.type,Date.now()),g.emit("onComposeBefore",{event:n,params:null!=t?t:{}});var v=u.listeners.actions;v.click.includes(t.type)?a.buildClickEvent(t,n):v.change.includes(t.type)?a.buildChangeEvent(t,n):v.submit.includes(t.type)&&a.buildSubmitEvent(t,n)}},this.getNodeXpath=function(e,t){var n,i,r,o=a.growingIO,l=o.gioPlatform,u=o.vdsConfig,d=(e.currentTarget||e.target).id;if((!d||"swan"===l&&/^_[0-9a-f]+/.test(d)||(i=(n=u.taro).Current,r=n.createComponent,n&&i&&!r&&/^_n_[0-9]+$/.test(d)))&&(d=""),!u.octopus||(t=e.handler,/^bound .*/.test(t)&&(t=t.replace("bound ","")),/^t[0-9]+$/.test(d)&&(d=""),d&&!t&&(t="anonymousFunc"),d||t))return"".concat(d,"#").concat(t)},this.buildClickEvent=function(n,i){var r,o,l,u=a.getNodeXpath(n,i);if(u){var d=a.growingIO,g=d.dataStore,v=g.eventContextBuilder,s=g.eventInterceptor,p=g.eventHooks,c=d.gioEnvironment,m=n.currentTarget||n.target,h=void 0;e.has(null==m?void 0:m.dataset,"index")&&""!==(null===(r=null==m?void 0:m.dataset)||void 0===r?void 0:r.index)&&(h=Number.parseInt(m.dataset.index,10),Number.isNaN(h)&&(h=-1)),s(t({eventType:"saas"===c&&n.type.includes("long")?"lngprss":"VIEW_CLICK",pageShowTimestamp:p.currentPage.time,element:[{xpath:u,index:h,textValue:null===(o=null==m?void 0:m.dataset)||void 0===o?void 0:o.title,hyperlink:null===(l=null==m?void 0:m.dataset)||void 0===l?void 0:l.src}]},v()))}},this.buildTabClickEvent=function(n){var i=a.growingIO.dataStore,r=i.eventContextBuilder,o=i.eventInterceptor,l=i.eventHooks;o(t({eventType:"VIEW_CLICK",pageShowTimestamp:l.currentPage.time,element:[{xpath:"#onTabItemTap",textValue:n.text,index:n.index,hyperlink:e.toString(n.pagePath)}]},r()))},this.buildChangeEvent=function(n,i){var r,o,l=a.getNodeXpath(n,i);if(l){var u=a.growingIO.dataStore,d=u.eventContextBuilder,g=u.eventInterceptor,v=u.eventHooks,s=n.currentTarget||n.target,p=t({eventType:"VIEW_CHANGE",pageShowTimestamp:v.currentPage.time,element:{xpath:l}},d()),c=e.get(n,"detail.value")||e.get(n,"target.attr.value");((null===(r=null==s?void 0:s.dataset)||void 0===r?void 0:r.growingTrack)||(null===(o=null==s?void 0:s.dataset)||void 0===o?void 0:o.growingtrack))&&(e.isNil(c)||(p.element.textValue=e.toString(c))),p.element=[p.element],g(p)}},this.buildSubmitEvent=function(e,n){var i=a.getNodeXpath(e,n);if(i){var r=a.growingIO.dataStore,o=r.eventContextBuilder,l=r.eventInterceptor,u=r.eventHooks;l(t({eventType:"FORM_SUBMIT",pageShowTimestamp:u.currentPage.time,element:[{xpath:i}]},o()))}},e=this.growingIO.utils,this.prevEvent={}}};export{n as default};
