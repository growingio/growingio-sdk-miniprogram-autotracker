const i=i=>"function"===t(i),t=i=>({}.toString.call(i).slice(8,-1).toLowerCase()),o=i=>{return(o=i,(i=>"[object Object]"==={}.toString.call(i)&&!(i=>["undefined","null"].includes(t(i)))(i))(o)?Object.keys(o):[]).filter((i=>i.indexOf("__sub")>-1&&i.indexOf("gio__")>-1)).sort();var o},s=()=>{let i=(i=>{try{return getApp({allowDefault:!0})}catch(i){return}})();return i||(i=global||$global),i};let g;var n={name:"gioMultiIntegrate",method:class{constructor(t){this.growingIO=t,this.addListener=()=>{const i=s();(null==i?void 0:i.gioEmitter)?null==i||i.gioEmitter.on("OPTION_CHANGE",(({optionName:i,optionValue:t})=>{this.storeUpdate("vdsConfig",i,t)})):g.consoleText("主包实例错误，请检查主包是否已集成插件!","warn")},this.storeUpdate=(t,g,n)=>{let e=s();const r=i(e.__gio__)?e.__gio__():e.__gio__;r&&(r[t][g]=n),o(e).forEach((o=>{const s=i(e[o])?e[o]():e[o];s[t]&&(s[t][g]=n)}))},g=this.growingIO.utils,this.growingIO.emitter.on("SDK_INITIALIZED",(()=>{this.subpackage=this.growingIO.vdsConfig.subpackage;const t=s();if(this.subpackage){this.growingIO.subKey=`__sub${o(t).length+1}_gio__`,this.subKey=this.growingIO.subKey,t[this.subKey]=()=>this.growingIO,this.growingIO.identify=()=>{};const s=i(t.__gio__)?t.__gio__():t.__gio__;s&&(g.keys(this.growingIO).forEach((i=>{g.isObject(this.growingIO[i])&&("vdsConfig"===i?g.keys(s.vdsConfig).forEach((i=>{["cml","remax","taro","taroVue","uniVue","wepy","subpackage"].includes(i)||(this.growingIO.vdsConfig[i]=s.vdsConfig[i])})):"plugins"!==i&&(this.growingIO[i]=s[i]))})),this.growingIO.vdsConfig.autotrack=!1,this.growingIO.plugins.uninstall("gioEventAutoTracking")&&g.consoleText("多项目集成，无埋点已自动关闭!","info"),this.addListener())}else{const i=s();this.growingIO.vdsConfig.autotrack=!1,this.growingIO.plugins.uninstall("gioEventAutoTracking")&&g.consoleText("多项目集成，无埋点已自动关闭!","info"),i.gioEmitter=this.growingIO.emitter,i.gio_esid=this.growingIO.dataStore.esid,i.gio_gsid=this.growingIO.dataStore.gsid}}))}}};export{n as default};
