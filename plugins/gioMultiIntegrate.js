const i=i=>"function"===t(i),t=i=>({}.toString.call(i).slice(8,-1).toLowerCase()),o=i=>{try{return i()}catch(i){return}},s=i=>{return(o=i,(i=>"[object Object]"==={}.toString.call(i)&&!(i=>["undefined","null"].includes(t(i)))(i))(o)?Object.keys(o):[]).filter((i=>i.indexOf("__sub")>-1&&i.indexOf("gio__")>-1)).sort();var o},n=()=>{let i=o((()=>getApp({allowDefault:!0})));return i||(i=g()),i},g=()=>{var i;return null!==(i=o((()=>$global)))&&void 0!==i?i:global};let e;var r={name:"gioMultiIntegrate",method:class{constructor(t){this.growingIO=t,this.addListener=()=>{const i=n();(null==i?void 0:i.gioEmitter)?null==i||i.gioEmitter.on("OPTION_CHANGE",(({optionName:i,optionValue:t})=>{this.storeUpdate("vdsConfig",i,t)})):e.consoleText("主包实例错误，请检查主包是否已集成插件!","warn")},this.storeUpdate=(t,o,g)=>{let e=n();const r=i(e.__gio__)?e.__gio__():e.__gio__;r&&(r[t][o]=g),s(e).forEach((s=>{const n=i(e[s])?e[s]():e[s];n[t]&&(n[t][o]=g)}))},e=this.growingIO.utils,this.growingIO.emitter.on("SDK_INITIALIZED",(()=>{this.subpackage=this.growingIO.vdsConfig.subpackage;const t=n();if(this.subpackage){this.growingIO.subKey=`__sub${s(t).length+1}_gio__`,this.subKey=this.growingIO.subKey,t[this.subKey]=()=>this.growingIO,this.growingIO.identify=()=>{};const o=i(t.__gio__)?t.__gio__():t.__gio__;o&&(e.keys(this.growingIO).forEach((i=>{e.isObject(this.growingIO[i])&&("vdsConfig"===i?e.keys(o.vdsConfig).forEach((i=>{["cml","remax","taro","taroVue","uniVue","wepy","subpackage"].includes(i)||(this.growingIO.vdsConfig[i]=o.vdsConfig[i])})):"plugins"!==i&&(this.growingIO[i]=o[i]))})),this.growingIO.vdsConfig.autotrack=!1,this.growingIO.plugins.uninstall("gioEventAutoTracking")&&e.consoleText("多项目集成，无埋点已自动关闭!","info"),this.addListener())}else{const i=n();this.growingIO.vdsConfig.autotrack=!1,this.growingIO.plugins.uninstall("gioEventAutoTracking")&&e.consoleText("多项目集成，无埋点已自动关闭!","info"),i.gioEmitter=this.growingIO.emitter,i.gio_esid=this.growingIO.dataStore.esid,i.gio_gsid=this.growingIO.dataStore.gsid}}))}}};export{r as default};
